

<h1 class="title">Tutorial de Ruby on Rails</h1>


<h1 class="subtitle">  Aprende Rails con ejemplos</h1>


<h2 class="author">Michael Hartl</h2>




<h1 class="contents">Contenido</h1>

<div id="table_of_contents"><ol><li class="chapter"><a href="beginning#top"><span class="number">Capítulo 1</span> Desde cero a implemetar</a></li><li><ol><li class="section"><a href="beginning#sec:introduction"><span class="number">1.1</span> Introducción</a></li><li><ol><li class="subsection"><a href="beginning#sec:comments_for_various_readers"><span class="number">1.1.1</span> Comentarios para varios lectores</a></li><li class="subsection"><a href="beginning#sec:1.1.2"><span class="number">1.1.2</span> “Escalar” Rails</a></li><li class="subsection"><a href="beginning#sec:conventions"><span class="number">1.1.3</span> Convenciones en este libro</a></li></ol></li><li class="section"><a href="beginning#sec:up_and_running"><span class="number">1.2</span> Ejecutando</a></li><li><ol><li class="subsection"><a href="beginning#sec:development_tools"><span class="number">1.2.1</span> Ambientes de desarrollo</a></li><li><ol><li class="subsubsection"><a href="beginning#sec:1.2.1.1">IDEs</a></li><li class="subsubsection"><a href="beginning#sec:1.2.1.2">Editores de texto y lineas de comandos</a></li><li class="subsubsection"><a href="beginning#sec:1.2.1.3">Navegadores</a></li><li class="subsubsection"><a href="beginning#sec:1.2.1.4">Una nota acerca de las herramientas</a></li></ol></li><li class="subsection"><a href="beginning#sec:rubygems"><span class="number">1.2.2</span> Ruby, RubyGems, Rails, y Git</a></li><li><ol><li class="subsubsection"><a href="beginning#sec:rails_installer_windows">Rails Installer (Windows)</a></li><li class="subsubsection"><a href="beginning#sec:install_git">Instalar Git</a></li><li class="subsubsection"><a href="beginning#sec:install_ruby">Instalar Ruby</a></li><li class="subsubsection"><a href="beginning#sec:install_rubygems">Instalar RubyGems</a></li><li class="subsubsection"><a href="beginning#sec:install_rails">Instalar Rails</a></li></ol></li><li class="subsection"><a href="beginning#sec:the_first_application"><span class="number">1.2.3</span> La primera aplicación</a></li><li class="subsection"><a href="beginning#sec:bundler"><span class="number">1.2.4</span> Bundler</a></li><li class="subsection"><a href="beginning#sec:rails_server"><span class="number">1.2.5</span> <code>rails server</code></a></li><li class="subsection"><a href="beginning#sec:mvc"><span class="number">1.2.6</span> Modelo-vista-controlador (MVC)</a></li></ol></li><li class="section"><a href="beginning#sec:version_control"><span class="number">1.3</span> Control de versiones con Git</a></li><li><ol><li class="subsection"><a href="beginning#sec:git_setup"><span class="number">1.3.1</span> Instalación y configuración</a></li><li><ol><li class="subsubsection"><a href="beginning#sec:1.3.1.1">Configuración del sistema por primera vez</a></li><li class="subsubsection"><a href="beginning#sec:1.3.1.2">Configuración del repositorio por primera vez</a></li></ol></li><li class="subsection"><a href="beginning#sec:adding_and_committing"><span class="number">1.3.2</span> Agregando y haciendo commit</a></li><li class="subsection"><a href="beginning#sec:1.3.3"><span class="number">1.3.3</span> Que bien te hace Git?</a></li><li class="subsection"><a href="beginning#sec:github"><span class="number">1.3.4</span> GitHub</a></li><li class="subsection"><a href="beginning#sec:git_commands"><span class="number">1.3.5</span> Branch, editar, commit, merge</a></li><li><ol><li class="subsubsection"><a href="beginning#sec:git_branch">Branch</a></li><li class="subsubsection"><a href="beginning#sec:git_edit">Editar</a></li><li class="subsubsection"><a href="beginning#sec:git_commit">Commit</a></li><li class="subsubsection"><a href="beginning#sec:git_merge">Merge</a></li><li class="subsubsection"><a href="beginning#sec:git_push">Push</a></li></ol></li></ol></li><li class="section"><a href="beginning#sec:deploying"><span class="number">1.4</span> Despliegue</a></li><li><ol><li class="subsection"><a href="beginning#sec:1.4.1"><span class="number">1.4.1</span> Configuración de Heroku</a></li><li class="subsection"><a href="beginning#sec:heroku_step_one"><span class="number">1.4.2</span> Desplegado en Heroku, paso uno</a></li><li class="subsection"><a href="beginning#sec:1.4.3"><span class="number">1.4.3</span> Desplegado en Heroku, paso dos</a></li><li class="subsection"><a href="beginning#sec:heroku_commands"><span class="number">1.4.4</span> Comandos de Heroku</a></li></ol></li><li class="section"><a href="beginning#sec:beginning_conclusion"><span class="number">1.5</span> Conclusión</a></li></ol></li><li class="chapter"><a href="a-demo-app#top"><span class="number">Capítulo 2</span> Una aplicación de demostración</a></li><li><ol><li class="section"><a href="a-demo-app#sec:planning_the_application"><span class="number">2.1</span> Planeando la aplicación</a></li><li><ol><li class="subsection"><a href="a-demo-app#sec:modeling_users"><span class="number">2.1.1</span> Modelando a los usuarios</a></li><li class="subsection"><a href="a-demo-app#sec:modeling_microposts"><span class="number">2.1.2</span> Modelando los micro-posts</a></li></ol></li><li class="section"><a href="a-demo-app#sec:demo_users_resource"><span class="number">2.2</span> El recurso users (usuarios)</a></li><li><ol><li class="subsection"><a href="a-demo-app#sec:a_user_tour"><span class="number">2.2.1</span> La gira de un usuario</a></li><li class="subsection"><a href="a-demo-app#sec:mvc_in_action"><span class="number">2.2.2</span> MVC en acción</a></li><li class="subsection"><a href="a-demo-app#sec:weaknesses_of_this_users_resource"><span class="number">2.2.3</span> Debilidades de este recurso users (usuarios)</a></li></ol></li><li class="section"><a href="a-demo-app#sec:microposts_resource"><span class="number">2.3</span> El recurso Microposts</a></li><li><ol><li class="subsection"><a href="a-demo-app#sec:a_micropost_microtour"><span class="number">2.3.1</span> La micro-gira de un micropost</a></li><li class="subsection"><a href="a-demo-app#sec:putting_the_micro_in_microposts"><span class="number">2.3.2</span> Poniendo el <em>micro</em> en microposts</a></li><li class="subsection"><a href="a-demo-app#sec:demo_user_has_many_microposts"><span class="number">2.3.3</span> Un usuario <code>has_many</code> microposts</a></li><li class="subsection"><a href="a-demo-app#sec:inheritance_hierarchies"><span class="number">2.3.4</span> Jerarquías de la herencia</a></li><li class="subsection"><a href="a-demo-app#sec:deploying_the_demo_app"><span class="number">2.3.5</span> Desplegando la aplicación de demostración</a></li></ol></li><li class="section"><a href="a-demo-app#sec:2.4"><span class="number">2.4</span> Conclusión</a></li></ol></li><li class="chapter"><a href="static-pages#top"><span class="number">Capítulo 3</span> Más que nada páginas estáticas</a></li><li><ol><li class="section"><a href="static-pages#sec:static_pages"><span class="number">3.1</span> Páginas estáticas</a></li><li><ol><li class="subsection"><a href="static-pages#sec:truly_static_pages"><span class="number">3.1.1</span> Verdaderas páginas estáticas</a></li><li class="subsection"><a href="static-pages#sec:static_pages_with_rails"><span class="number">3.1.2</span> Páginas estáticas con Rails</a></li></ol></li><li class="section"><a href="static-pages#sec:first_tests"><span class="number">3.2</span> Nuestras primeras pruebas</a></li><li><ol><li class="subsection"><a href="static-pages#sec:testing_tools"><span class="number">3.2.1</span> Herramientas para pruebas</a></li><li><ol><li class="subsubsection"><a href="static-pages#sec:autotest">Autotest</a></li></ol></li><li class="subsection"><a href="static-pages#sec:TDD"><span class="number">3.2.2</span> TDD: Rojo, Verde, Refactorizar</a></li><li><ol><li class="subsubsection"><a href="static-pages#sec:spork">Spork</a></li><li class="subsubsection"><a href="static-pages#sec:red">Rojo</a></li><li class="subsubsection"><a href="static-pages#sec:green">Verde</a></li><li class="subsubsection"><a href="static-pages#sec:refactor">Refactorizar</a></li></ol></li></ol></li><li class="section"><a href="static-pages#sec:slightly_dynamic_pages"><span class="number">3.3</span> Páginas ligeramente dinamicas</a></li><li><ol><li class="subsection"><a href="static-pages#sec:testing_a_title_change"><span class="number">3.3.1</span> Probando un cambio en el titulo</a></li><li class="subsection"><a href="static-pages#sec:passing_title_tests"><span class="number">3.3.2</span> Pasando las pruebas de titulo</a></li><li class="subsection"><a href="static-pages#sec:instance_variables_embedded_ruby"><span class="number">3.3.3</span> Variables de instancia y Ruby incrustado</a></li><li class="subsection"><a href="static-pages#sec:layouts"><span class="number">3.3.4</span> Eliminando duplicación con layout (plantillas)</a></li></ol></li><li class="section"><a href="static-pages#sec:static_pages_conclusion"><span class="number">3.4</span> Conclusión</a></li><li class="section"><a href="static-pages#sec:static_pages_exercises"><span class="number">3.5</span> Ejercicios</a></li></ol></li><li class="chapter"><a href="rails-flavored-ruby#top"><span class="number">Capítulo 4</span> Ruby con sabor a Rails</a></li><li><ol><li class="section"><a href="rails-flavored-ruby#sec:motivation"><span class="number">4.1</span> Motivación</a></li><li><ol><li class="subsection"><a href="rails-flavored-ruby#sec:title_helper"><span class="number">4.1.1</span> Un helper llamado <code>title</code></a></li><li class="subsection"><a href="rails-flavored-ruby#sec:cascading_style_sheets"><span class="number">4.1.2</span> Hojas de Estilo en Cascada (CSS)</a></li></ol></li><li class="section"><a href="rails-flavored-ruby#sec:strings_and_methods"><span class="number">4.2</span> Cadenas y métodos</a></li><li><ol><li class="subsection"><a href="rails-flavored-ruby#sec:comments"><span class="number">4.2.1</span> Comentarios</a></li><li class="subsection"><a href="rails-flavored-ruby#sec:strings"><span class="number">4.2.2</span> Cadenas</a></li><li><ol><li class="subsubsection"><a href="rails-flavored-ruby#sec:printing">Imprimiendo</a></li><li class="subsubsection"><a href="rails-flavored-ruby#sec:single_quoted_strings">Cadenas con comillas simples</a></li></ol></li><li class="subsection"><a href="rails-flavored-ruby#sec:objects_and_message_passing"><span class="number">4.2.3</span> Objetos y envio de mensajes</a></li><li class="subsection"><a href="rails-flavored-ruby#sec:method_definitions"><span class="number">4.2.4</span> Definición de métodos</a></li><li class="subsection"><a href="rails-flavored-ruby#sec:back_to_the_title_helper"><span class="number">4.2.5</span> De vuelta a nuestro helper <code>title</code></a></li></ol></li><li class="section"><a href="rails-flavored-ruby#sec:other_data_structures"><span class="number">4.3</span> Otras estructuras de datos</a></li><li><ol><li class="subsection"><a href="rails-flavored-ruby#sec:arrays_and_ranges"><span class="number">4.3.1</span> Arreglos y rangos</a></li><li class="subsection"><a href="rails-flavored-ruby#sec:blocks"><span class="number">4.3.2</span> Bloques</a></li><li class="subsection"><a href="rails-flavored-ruby#sec:hashes_and_symbols"><span class="number">4.3.3</span> Hashes (Arreglos asociativos) y simbolos</a></li><li class="subsection"><a href="rails-flavored-ruby#sec:css_revisited"><span class="number">4.3.4</span> CSS revisited</a></li></ol></li><li class="section"><a href="rails-flavored-ruby#sec:ruby_classes"><span class="number">4.4</span> Clases en Ruby</a></li><li><ol><li class="subsection"><a href="rails-flavored-ruby#sec:constructors"><span class="number">4.4.1</span> Constructores</a></li><li class="subsection"><a href="rails-flavored-ruby#sec:a_class_of_our_own"><span class="number">4.4.2</span> Herencia</a></li><li class="subsection"><a href="rails-flavored-ruby#sec:modifying_built_in_classes"><span class="number">4.4.3</span> Modificando las clases incluidas con ruby</a></li><li class="subsection"><a href="rails-flavored-ruby#sec:a_controller_class"><span class="number">4.4.4</span> Una clase controlador</a></li><li class="subsection"><a href="rails-flavored-ruby#sec:a_user_class"><span class="number">4.4.5</span> Una clase user (usuario)</a></li></ol></li><li class="section"><a href="rails-flavored-ruby#sec:exercises"><span class="number">4.5</span> Ejercicios</a></li></ol></li><li class="chapter"><a href="filling-in-the-layout#top"><span class="number">Capítulo 5</span> Llenando el layout (plantilla)</a></li><li><ol><li class="section"><a href="filling-in-the-layout#sec:structure"><span class="number">5.1</span> Agregando un poco de estructura</a></li><li><ol><li class="subsection"><a href="filling-in-the-layout#sec:adding_to_the_layout"><span class="number">5.1.1</span> Navegación del sitio</a></li><li class="subsection"><a href="filling-in-the-layout#sec:custom_css"><span class="number">5.1.2</span> CSS personalizado</a></li><li class="subsection"><a href="filling-in-the-layout#sec:partials"><span class="number">5.1.3</span> Parciales</a></li></ol></li><li class="section"><a href="filling-in-the-layout#sec:layout_links"><span class="number">5.2</span> Ligas en las plantillas</a></li><li><ol><li class="subsection"><a href="filling-in-the-layout#sec:integration_tests"><span class="number">5.2.1</span> Pruebas de integración</a></li><li class="subsection"><a href="filling-in-the-layout#sec:rails_routes"><span class="number">5.2.2</span> Rutas de Rails</a></li><li class="subsection"><a href="filling-in-the-layout#sec:named_routes"><span class="number">5.2.3</span> Rutas nombradas</a></li></ol></li><li class="section"><a href="filling-in-the-layout#sec:user_signup"><span class="number">5.3</span> Registro de usuario: El primer paso</a></li><li><ol><li class="subsection"><a href="filling-in-the-layout#sec:users_controller"><span class="number">5.3.1</span> Controlador de Usuarios</a></li><li class="subsection"><a href="filling-in-the-layout#sec:signup_url"><span class="number">5.3.2</span> URL de registro</a></li></ol></li><li class="section"><a href="filling-in-the-layout#sec:layout_conclusion"><span class="number">5.4</span> Conclusión</a></li><li class="section"><a href="filling-in-the-layout#sec:layout_exercises"><span class="number">5.5</span> Ejercicios</a></li></ol></li><li class="chapter"><a href="modeling-and-viewing-users-one#top"><span class="number">Capítulo 6</span> Modelando y mostrando usuarios, parte I</a></li><li><ol><li class="section"><a href="modeling-and-viewing-users-one#sec:user_model"><span class="number">6.1</span> Modelo User (usuario)</a></li><li><ol><li class="subsection"><a href="modeling-and-viewing-users-one#sec:database_migrations"><span class="number">6.1.1</span> Migraciones de bases de datos</a></li><li class="subsection"><a href="modeling-and-viewing-users-one#sec:the_model_file"><span class="number">6.1.2</span> El archivo del modelo</a></li><li><ol><li class="subsubsection"><a href="modeling-and-viewing-users-one#sec:model_annotation">Anotaciones del modelo</a></li><li class="subsubsection"><a href="modeling-and-viewing-users-one#sec:accessible_attributes">Atributos accesibles</a></li></ol></li><li class="subsection"><a href="modeling-and-viewing-users-one#sec:creating_user_objects"><span class="number">6.1.3</span> Creando objetos usuario</a></li><li class="subsection"><a href="modeling-and-viewing-users-one#sec:finding_user_objects"><span class="number">6.1.4</span> Buscando objetos usuario</a></li><li class="subsection"><a href="modeling-and-viewing-users-one#sec:updating_user_objects"><span class="number">6.1.5</span> Actualizando objetos usuario</a></li></ol></li><li class="section"><a href="modeling-and-viewing-users-one#sec:user_validations"><span class="number">6.2</span> Validaciones de usuario</a></li><li><ol><li class="subsection"><a href="modeling-and-viewing-users-one#sec:presence_validation"><span class="number">6.2.1</span> Validando presencia</a></li><li class="subsection"><a href="modeling-and-viewing-users-one#sec:length_validation"><span class="number">6.2.2</span> Validación de longitud</a></li><li class="subsection"><a href="modeling-and-viewing-users-one#sec:format_validation"><span class="number">6.2.3</span> Validación de formato</a></li><li class="subsection"><a href="modeling-and-viewing-users-one#sec:uniqueness_validation"><span class="number">6.2.4</span> Validación de identidad</a></li><li><ol><li class="subsubsection"><a href="modeling-and-viewing-users-one#sec:the_caveat">Advertencia acerca de la identidad</a></li></ol></li></ol></li><li class="section"><a href="modeling-and-viewing-users-one#sec:viewing_users"><span class="number">6.3</span> Mostrando usuarios</a></li><li><ol><li class="subsection"><a href="modeling-and-viewing-users-one#sec:rails_environments"><span class="number">6.3.1</span> Depuración y los ambientes de Rails</a></li><li class="subsection"><a href="modeling-and-viewing-users-one#sec:users_show"><span class="number">6.3.2</span> El modelo User (usuario), vista, controlador</a></li><li class="subsection"><a href="modeling-and-viewing-users-one#sec:a_users_resource"><span class="number">6.3.3</span> El recurso usuario</a></li><li><ol><li class="subsubsection"><a href="modeling-and-viewing-users-one#sec:params_in_debug"><code>params</code> en <code>debug (depuración)</code></a></li></ol></li></ol></li><li class="section"><a href="modeling-and-viewing-users-one#sec:6.4"><span class="number">6.4</span> Conclusión</a></li><li class="section"><a href="modeling-and-viewing-users-one#sec:6.5"><span class="number">6.5</span> Ejercicios</a></li></ol></li><li class="chapter"><a href="modeling-and-viewing-users-two#top"><span class="number">Capítulo 7</span> Modelando y mostrando usuarios, parte II</a></li><li><ol><li class="section"><a href="modeling-and-viewing-users-two#sec:insecure_passwords"><span class="number">7.1</span> Contraseñas inseguras</a></li><li><ol><li class="subsection"><a href="modeling-and-viewing-users-two#sec:password_validations"><span class="number">7.1.1</span> Validaciones de contraseña</a></li><li class="subsection"><a href="modeling-and-viewing-users-two#sec:password_migration"><span class="number">7.1.2</span> Migración para contraseña</a></li><li class="subsection"><a href="modeling-and-viewing-users-two#sec:an_active_record_callback"><span class="number">7.1.3</span> Llamadas de Active Record</a></li></ol></li><li class="section"><a href="modeling-and-viewing-users-two#sec:secure_passwords"><span class="number">7.2</span> Contraseñas seguras</a></li><li><ol><li class="subsection"><a href="modeling-and-viewing-users-two#sec:a_secure_password_test"><span class="number">7.2.1</span> Prueba para contraseñas seguras</a></li><li class="subsection"><a href="modeling-and-viewing-users-two#sec:secure_password_theory"><span class="number">7.2.2</span> Una teoria acerca de las contraseñas seguras</a></li><li class="subsection"><a href="modeling-and-viewing-users-two#sec:implementing_has_password"><span class="number">7.2.3</span> Implementando <code>has_password?</code></a></li><li class="subsection"><a href="modeling-and-viewing-users-two#sec:an_authenticate_method"><span class="number">7.2.4</span> El método authenticate (autenticar)</a></li></ol></li><li class="section"><a href="modeling-and-viewing-users-two#sec:better_user_views"><span class="number">7.3</span> Mejores vistas de usuario</a></li><li><ol><li class="subsection"><a href="modeling-and-viewing-users-two#sec:tests_with_factories"><span class="number">7.3.1</span> Probando la página mostrar usuarios (con factories)</a></li><li class="subsection"><a href="modeling-and-viewing-users-two#sec:a_name_and_a_gravatar"><span class="number">7.3.2</span> Un nombre y un Gravatar</a></li><li><ol><li class="subsubsection"><a href="modeling-and-viewing-users-two#sec:a_gravatar_helper">El helper Gravatar</a></li></ol></li><li class="subsection"><a href="modeling-and-viewing-users-two#sec:a_user_sidebar"><span class="number">7.3.3</span> Una barra lateral de usuario</a></li></ol></li><li class="section"><a href="modeling-and-viewing-users-two#sec:7.4"><span class="number">7.4</span> Conclusión</a></li><li><ol><li class="subsection"><a href="modeling-and-viewing-users-two#sec:7.4.1"><span class="number">7.4.1</span> Git commit</a></li><li class="subsection"><a href="modeling-and-viewing-users-two#sec:heroku_deploy"><span class="number">7.4.2</span> Desplegaod en Heroku</a></li></ol></li><li class="section"><a href="modeling-and-viewing-users-two#sec:more_modeling_users_exercises"><span class="number">7.5</span> Ejercicios</a></li></ol></li><li class="chapter"><a href="sign-up#top"><span class="number">Capítulo 8</span> Registro</a></li><li><ol><li class="section"><a href="sign-up#sec:signup_form"><span class="number">8.1</span> Formulario de registro</a></li><li><ol><li class="subsection"><a href="sign-up#sec:using_form_for"><span class="number">8.1.1</span> Usando <code>form_for</code></a></li><li class="subsection"><a href="sign-up#sec:the_form_html"><span class="number">8.1.2</span> El formulario HTML</a></li></ol></li><li class="section"><a href="sign-up#sec:signup_failure"><span class="number">8.2</span> Registro fallído</a></li><li><ol><li class="subsection"><a href="sign-up#sec:testing_failure"><span class="number">8.2.1</span> Probando el fallo</a></li><li class="subsection"><a href="sign-up#sec:a_working_form"><span class="number">8.2.2</span> Un formulario funcional</a></li><li class="subsection"><a href="sign-up#sec:signup_error_messages"><span class="number">8.2.3</span> Mensajes de error de registro</a></li><li class="subsection"><a href="sign-up#sec:filtering_parameter_logging"><span class="number">8.2.4</span> Filtrando parametros de la bitácora</a></li></ol></li><li class="section"><a href="sign-up#sec:signup_success"><span class="number">8.3</span> Registro exitoso</a></li><li><ol><li class="subsection"><a href="sign-up#sec:testing_success"><span class="number">8.3.1</span> Probando el éxito</a></li><li class="subsection"><a href="sign-up#sec:the_finished_signup_form"><span class="number">8.3.2</span> El formulario de registro terminado</a></li><li class="subsection"><a href="sign-up#sec:the_flash"><span class="number">8.3.3</span> El flash</a></li><li class="subsection"><a href="sign-up#sec:the_first_signup"><span class="number">8.3.4</span> El primer registro</a></li></ol></li><li class="section"><a href="sign-up#sec:rspec_integration_tests"><span class="number">8.4</span> Pruebas de integración con RSpec</a></li><li><ol><li class="subsection"><a href="sign-up#sec:integration_tests_with_style"><span class="number">8.4.1</span> Pruebas de integración con estilo</a></li><li class="subsection"><a href="sign-up#sec:failed_signup"><span class="number">8.4.2</span> Los registros fallidos no deben crear un nuevo usuario</a></li><li class="subsection"><a href="sign-up#sec:successful_signup"><span class="number">8.4.3</span> Los registros exitosos debe crear un nuevo usuario</a></li></ol></li><li class="section"><a href="sign-up#sec:8.5"><span class="number">8.5</span> Conclusión</a></li><li class="section"><a href="sign-up#sec:signup_exercises"><span class="number">8.6</span> Ejercicios</a></li></ol></li><li class="chapter"><a href="sign-in-sign-out#top"><span class="number">Capítulo 9</span> Iniciar sesión, cerrar sesión</a></li><li><ol><li class="section"><a href="sign-in-sign-out#sec:sessions"><span class="number">9.1</span> Sesiones</a></li><li><ol><li class="subsection"><a href="sign-in-sign-out#sec:sessions_controller"><span class="number">9.1.1</span> Controlador Sessions (Sesiones)</a></li><li class="subsection"><a href="sign-in-sign-out#sec:signin_form"><span class="number">9.1.2</span> Formulario para iniciar sesión</a></li></ol></li><li class="section"><a href="sign-in-sign-out#sec:signin_failure"><span class="number">9.2</span> Inicio de sesión fallido</a></li><li><ol><li class="subsection"><a href="sign-in-sign-out#sec:reviewing_form_submission"><span class="number">9.2.1</span> Revisando el envio del formulario</a></li><li class="subsection"><a href="sign-in-sign-out#sec:failed_signin"><span class="number">9.2.2</span> Inicio de sesión fallido (prueba y code)</a></li></ol></li><li class="section"><a href="sign-in-sign-out#sec:signin_success"><span class="number">9.3</span> Inicio de sesión exitoso</a></li><li><ol><li class="subsection"><a href="sign-in-sign-out#sec:the_completed_create_action"><span class="number">9.3.1</span> La acción <code>create</code> completa</a></li><li class="subsection"><a href="sign-in-sign-out#sec:remember_me"><span class="number">9.3.2</span> Recordarme</a></li><li class="subsection"><a href="sign-in-sign-out#sec:current_user"><span class="number">9.3.3</span> Usuario actual</a></li></ol></li><li class="section"><a href="sign-in-sign-out#sec:signing_out"><span class="number">9.4</span> Cerrar sesión</a></li><li><ol><li class="subsection"><a href="sign-in-sign-out#sec:destroying_sessions"><span class="number">9.4.1</span> Destruyendo sesiones</a></li><li class="subsection"><a href="sign-in-sign-out#sec:signin_upon_signup"><span class="number">9.4.2</span> Iniciar sesión despues de registrar</a></li><li class="subsection"><a href="sign-in-sign-out#sec:changing_the_layout_links"><span class="number">9.4.3</span> Cambiando las ligas de la plantilla</a></li><li class="subsection"><a href="sign-in-sign-out#sec:signin_out_integration_tests"><span class="number">9.4.4</span> Pruebas de integración de iniciar/cerrar sesión</a></li></ol></li><li class="section"><a href="sign-in-sign-out#sec:9.5"><span class="number">9.5</span> Conclusión</a></li><li class="section"><a href="sign-in-sign-out#sec:sign_in_out_exercises"><span class="number">9.6</span> Ejercicios</a></li></ol></li><li class="chapter"><a href="updating-showing-and-deleting-users#top"><span class="number">Capítulo 10</span> Actualizando, mostrando y borrando usuarios</a></li><li><ol><li class="section"><a href="updating-showing-and-deleting-users#sec:updating_users"><span class="number">10.1</span> Actualizando usuarios</a></li><li><ol><li class="subsection"><a href="updating-showing-and-deleting-users#sec:edit_form"><span class="number">10.1.1</span> El formulario editar</a></li><li class="subsection"><a href="updating-showing-and-deleting-users#sec:enabling_edits"><span class="number">10.1.2</span> Habilitando la edición</a></li></ol></li><li class="section"><a href="updating-showing-and-deleting-users#sec:protecting_pages"><span class="number">10.2</span> Protegiendo páginas</a></li><li><ol><li class="subsection"><a href="updating-showing-and-deleting-users#sec:requiring_signed_in_users"><span class="number">10.2.1</span> Requiriendo usuarios firmando</a></li><li class="subsection"><a href="updating-showing-and-deleting-users#sec:requiring_the_right_user"><span class="number">10.2.2</span> Requiriendo el usuario correcto</a></li><li class="subsection"><a href="updating-showing-and-deleting-users#sec:friendly_forwarding"><span class="number">10.2.3</span> Envio amistoso</a></li></ol></li><li class="section"><a href="updating-showing-and-deleting-users#sec:showing_users"><span class="number">10.3</span> Mostrando usuarios</a></li><li><ol><li class="subsection"><a href="updating-showing-and-deleting-users#sec:user_index"><span class="number">10.3.1</span> Índice de usuarios</a></li><li class="subsection"><a href="updating-showing-and-deleting-users#sec:sample_users"><span class="number">10.3.2</span> Usuarios muestra</a></li><li class="subsection"><a href="updating-showing-and-deleting-users#sec:pagination"><span class="number">10.3.3</span> Paginación</a></li><li><ol><li class="subsubsection"><a href="updating-showing-and-deleting-users#sec:testing_pagination">Probando la paginación</a></li></ol></li><li class="subsection"><a href="updating-showing-and-deleting-users#sec:partial_refactoring"><span class="number">10.3.4</span> Refactorizando parciales</a></li></ol></li><li class="section"><a href="updating-showing-and-deleting-users#sec:destroying_users"><span class="number">10.4</span> Destroyendo usuarios</a></li><li><ol><li class="subsection"><a href="updating-showing-and-deleting-users#sec:administrative_users"><span class="number">10.4.1</span> Usuarios adminsitrativos</a></li><li><ol><li class="subsubsection"><a href="updating-showing-and-deleting-users#sec:revisiting_attr_accessible">Revisitando <code>attr_accessible</code></a></li></ol></li><li class="subsection"><a href="updating-showing-and-deleting-users#sec:the_destroy_action"><span class="number">10.4.2</span> La acción <code>destroy</code></a></li></ol></li><li class="section"><a href="updating-showing-and-deleting-users#sec:10.5"><span class="number">10.5</span> Conclusión</a></li><li class="section"><a href="updating-showing-and-deleting-users#sec:updating_deleting_exercises"><span class="number">10.6</span> Ejercicios</a></li></ol></li><li class="chapter"><a href="user-microposts#top"><span class="number">Capítulo 11</span> Microposts de usuario</a></li><li><ol><li class="section"><a href="user-microposts#sec:a_micropost_model"><span class="number">11.1</span> El modelo Micropost</a></li><li><ol><li class="subsection"><a href="user-microposts#sec:the_basíc_model"><span class="number">11.1.1</span> El modelo básico</a></li><li><ol><li class="subsubsection"><a href="user-microposts#sec:accessible_attribute">Atributo accesible</a></li></ol></li><li class="subsection"><a href="user-microposts#sec:user_micropost_associations"><span class="number">11.1.2</span> Asociaciones User/Micropost</a></li><li class="subsection"><a href="user-microposts#sec:ordering_and_dependency"><span class="number">11.1.3</span> Refinamientos a Micropost</a></li><li><ol><li class="subsubsection"><a href="user-microposts#sec:default_scope">Default scope</a></li><li class="subsubsection"><a href="user-microposts#sec:dependent_destroy">Dependent: destroy</a></li></ol></li><li class="subsection"><a href="user-microposts#sec:micropost_validations"><span class="number">11.1.4</span> Validaciones&#160; de Micropost</a></li></ol></li><li class="section"><a href="user-microposts#sec:showing_microposts"><span class="number">11.2</span> Mostrando microposts</a></li><li><ol><li class="subsection"><a href="user-microposts#sec:augmenting_the_user_show_page"><span class="number">11.2.1</span> Aumentando la página de mostrar usuarios</a></li><li class="subsection"><a href="user-microposts#sec:sample_microposts"><span class="number">11.2.2</span> Microposts de muestra</a></li></ol></li><li class="section"><a href="user-microposts#sec:manipulating_microposts"><span class="number">11.3</span> Manipulando microposts</a></li><li><ol><li class="subsection"><a href="user-microposts#sec:access_control"><span class="number">11.3.1</span> Control de acceso</a></li><li class="subsection"><a href="user-microposts#sec:creating_microposts"><span class="number">11.3.2</span> Creando microposts</a></li><li class="subsection"><a href="user-microposts#sec:a_proto_feed"><span class="number">11.3.3</span> Un proto-feed</a></li><li class="subsection"><a href="user-microposts#sec:destroying_microposts"><span class="number">11.3.4</span> Destroyendo microposts</a></li><li class="subsection"><a href="user-microposts#sec:testing_the_new_home_page"><span class="number">11.3.5</span> Probando la nueva página de inicio</a></li></ol></li><li class="section"><a href="user-microposts#sec:11.4"><span class="number">11.4</span> Conclusión</a></li><li class="section"><a href="user-microposts#sec:micropost_exercises"><span class="number">11.5</span> Ejercicios</a></li></ol></li><li class="chapter"><a href="following-users#top"><span class="number">Capítulo 12</span> Siguendo usuarios</a></li><li><ol><li class="section"><a href="following-users#sec:the_relationship_model"><span class="number">12.1</span> El modelo relacional</a></li><li><ol><li class="subsection"><a href="following-users#sec:a_problem_with_the_data_model"><span class="number">12.1.1</span> Un problema con el modelo de datos (y una solución)</a></li><li class="subsection"><a href="following-users#sec:relationship_user_associations"><span class="number">12.1.2</span> Relaciones y asociaciones de User (Usuario)</a></li><li class="subsection"><a href="following-users#sec:relationship_validations"><span class="number">12.1.3</span> Validaciones</a></li><li class="subsection"><a href="following-users#sec:following"><span class="number">12.1.4</span> Siguiendo</a></li><li class="subsection"><a href="following-users#sec:followers"><span class="number">12.1.5</span> Seguidores</a></li></ol></li><li class="section"><a href="following-users#sec:a_web_interface_for_following_and_followers"><span class="number">12.2</span> Una interface web para seguir y seguidores</a></li><li><ol><li class="subsection"><a href="following-users#sec:sample_following_data"><span class="number">12.2.1</span> Información muestr de seguidores</a></li><li class="subsection"><a href="following-users#sec:stats_and_a_follow_form"><span class="number">12.2.2</span> Estadisticas y formulario para seguir</a></li><li class="subsection"><a href="following-users#sec:following_and_followers_pages"><span class="number">12.2.3</span> Páginas de seguir y seguidores</a></li><li class="subsection"><a href="following-users#sec:a_working_follow_button_the_standard_way"><span class="number">12.2.4</span> Un botón de seguir funcional de la manera estándar</a></li><li class="subsection"><a href="following-users#sec:a_working_follow_button_with_ajax"><span class="number">12.2.5</span> Un botón de seguir funcional con Ajax</a></li></ol></li><li class="section"><a href="following-users#sec:the_status_feed"><span class="number">12.3</span> El feed de estado</a></li><li><ol><li class="subsection"><a href="following-users#sec:motivation_and_strategy"><span class="number">12.3.1</span> Motivación y estrategía</a></li><li class="subsection"><a href="following-users#sec:a_first_feed_implementation"><span class="number">12.3.2</span> La primer implementación de feeds</a></li><li class="subsection"><a href="following-users#sec:scopes_subselects_and_a_lambda"><span class="number">12.3.3</span> Scope, sub-select, y lambda</a></li><li class="subsection"><a href="following-users#sec:the_new_status_feed"><span class="number">12.3.4</span> El nuevo feed de estado</a></li></ol></li><li class="section"><a href="following-users#sec:following_conclusion"><span class="number">12.4</span> Conclusión</a></li><li><ol><li class="subsection"><a href="following-users#sec:extensions_to_the_sample_application"><span class="number">12.4.1</span> Extensiones para la aplicación de muestra</a></li><li><ol><li class="subsubsection"><a href="following-users#sec:replies">Respuestas</a></li><li class="subsubsection"><a href="following-users#sec:messaging">Mensajeria</a></li><li class="subsubsection"><a href="following-users#sec:follower_notifications">Notificaciones de seguidores</a></li><li class="subsubsection"><a href="following-users#sec:password_reminders">Recordatorios de contrseña</a></li><li class="subsubsection"><a href="following-users#sec:signup_confirmation">Confirmación de registro</a></li><li class="subsubsection"><a href="following-users#sec:rss_feed">feed RSS</a></li><li class="subsubsection"><a href="following-users#sec:rest_api">API REST</a></li><li class="subsubsection"><a href="following-users#sec:search">Busquedas</a></li></ol></li><li class="subsection"><a href="following-users#sec:guide_to_further_resources"><span class="number">12.4.2</span> Guía a más recursos</a></li></ol></li><li class="section"><a href="following-users#sec:following_exercises"><span class="number">12.5</span> Ejercicios</a></li></ol></li></ol></div>

<div id="main_content"></div>


<p> <span class="preamble">
 <span id="foreword">
<strong> Prólogo</strong> <br />
 </span>
 </span></p>
<p>Mi previa compañía (CD Baby) fue una de las primeras en cambiar a Ruby on Rails, y con aun más prisa, de regresar a PHP (Busca por mi en Google para leer acerca de ese escandalo). Esté libro, por Michael Hartl, me fue tan altamente recomendado que tube que leerlo, y así fue como <em>Rails Tutorial</em> me ayudo a volver de vuelta a Rails.</p>

<p>Este fue el primer libro que me ayudo a entender "la manera de Rails"; una manera que al principio no senti muy natural, pero eso cambio al leer este libro. Aparte, <em>Rails Tutorial</em> muestra como desarrollar tú aplicación usando pruebas, una forma altamente recomendada por los expertos pero que no se habia demonstrado antes. Por último, al incluir instrucción en Git, Github, y Heroku, el proceso de desarrolar software con Rails se demuestra por completo.</p>

<p>El formato del libro es genial, ya que el mayor beneficio se obtiene al hacer el esfuerzo de completar todos los ejemplos y ejercicios, capítulo tras capítulo, y sin saltar secciones.</p>

<p>Disfrutenlo!</p>

<p><a href="http://sivers.org/">Derek Sivers</a> (<a href="http://sivers.org/">sivers.org</a>) <br />
<em>Previamente: Fundador,</em> <a href="http://www.cdbaby.com/"><em>CD Baby</em></a> <br />
<em>Actualmente: Fundador,</em> <a href="http://thoughts.pro/"><em>Thoughts Ltd.</em></a> <br /></p>

<p> <span class="preamble">
<strong> Reconocimientos</strong> <br />
 </span></p>

<p>El contenido de <em>Ruby on Rails Tutorial</em> debe mucho a <em>RailsSpace</em> - un libro que escribí previo a este - y por lo tanto, a su coautor, <a href="http://aure.com/">Aurelius Prochazka</a>. Me gustaria agradecerle por todo el trabajo que hizo en <em>RailsSpace</em> y por toda su ayuda en éste. Tambien me gustaria agradecer a Debra Williams Cauley, mi editora en ambos libros. Mientras ella siga llevandome a juegos de Baseball, yo seguire escribiendo libros por ella.</p>

<p>Le mando flores a una larga lista de Rubyistas que me han enseñado e inspirado por los años: David Heinemeier Hansson, Yehuda Katz, Carl Lerche, Jeremy Kemper, Xavier Noria, Ryan Bates, Geoffrey Grosenbach, Peter Cooper, Matt Aimonetti, Gregg Pollack, Wayne&nbsp;E. Seguin, Amy Hoy, Dave Chelimsky, Pat Maddox, Tom Preston-Werner, Chris Wanstrath, Chad Fowler, Josh Susser, Obie Fernandez, Ian McFarland, Steven Bristol, Giles Bowkett, Evan Dorn, Long Nguyen, James Lindenbaum, Adam Wiggins, Tikhon Bernstam, Ron Evans, Wyatt Greene, Miles Forrest, a toda la buena gente de Pivotal Labs, y a los camaradas de Heroku, thoughtbot, y GitHub. Y más que nada, muchas, muchas gracias a todos mis lectores. Gracias por contribuir a este libro por su tiempo reportando bugs y dando sugerecias. Sinceramente, sin su ayuda, este libro no hubiera sido tan bueno.</p>

<p> <span class="preamble">
 <span id="author">
<strong> Acerca del autor</strong> <br />
 </span>
 </span></p>
<p><a href="http://michaelhartl.com/">Michael Hartl</a> es un programador, maestro, y empresario, coautor de <em>RailsSpace</em>, un tutorial exitoso de Rails publicado en el 2007. Tambien fue cofundador y líder de desarrollo en <a href="http://insoshi.com/">Insoshi</a>, una plataforma <a href="http://github.com/popular/forked">popular</a> de redes sociales escrita en Ruby on Rails. Antes de eso, Michael enseño física teóretica y computacional en <a href-"http://www.caltech.edu">Caltech</a>, el Instituto de Tecnología de California, donde se le reconocio por su excellencia en educación. Michael obtuvo su titulo en <a href="http://college.harvard.edu/">Harvard College</a>, y <a href="http://resolver.caltech.edu/CaltechETD:etd-05222003-161626">su doctorado en física</a> en Caltech. Aparte, es un ex-alumno del programa empresarial de <a href="http://ycombinator.com/">Y&nbsp;Combinator</a><br /></p>

<p> <span id="license" class="preamble">
<strong> Copyright and license</strong> <br />
 </span></p>

<p><em>Ruby on Rails Tutorial: Learn Rails by Example</em>. Copyright &copy; 2010 by Michael Hartl. All source code in <em>Ruby on Rails Tutorial</em> is available under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a> and the <a href="http://en.wikipedia.org/wiki/Beerware">Beerware License</a>.</p>

<pre class="verbatim">   Copyright (c) 2010 Michael Hartl

   Permission is hereby granted, free of charge, to any person
   obtaining a copy of this software and associated documentation
   files (the &quot;Software&quot;), to deal in the Software without
   restriction, including without limitation the rights to use,
   copy, modify, merge, publish, distribute, sublicense, and/or sell
   copies of the Software, and to permit persons to whom the
   Software is furnished to do so, subject to the following
   conditions:

   The above copyright notice and this permission notice shall be
   included in all copies or substantial portions of the Software.

   THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
   OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
   NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
   HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
   WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
   OTHER DEALINGS IN THE SOFTWARE.</pre>




<pre class="verbatim">/*
 * ------------------------------------------------------------
 * &quot;THE BEERWARE LICENSE&quot; (Revision 42):
 * Michael Hartl wrote this code. As long as you retain this 
 * notice, you can do whatever you want with this stuff. If we
 * meet someday, and you think this stuff is worth it, you can
 * buy me a beer in return.
 * ------------------------------------------------------------
 */</pre>




<div id="top"></div>


<h1 class="chapter"><a id="sec:2" href="a-demo-app#top" class="heading"><span class="number">Capítulo 2</span> Una demostración</a></h1>

<p>En este capítulo desarrollaremos una simple aplicación con Rails que nos permitirá ver algo de su capacidad. El propósito de ésto es obtener una visión más general de como se desarrolla una aplicación con Ruby on Rails (y para la web en general). El uso de <em>andamios</em>, (scaffold generators)</em><sup class="footnote" id="fnref:2.1"><a href="#fn:2.1">1</a></sup> nos permitirá generar la aplicación rapidamente, pero como se explica en la <a class="ref" href="beginning#sidebar:scaffolding">Caja&nbsp;1.1</a>, el resto de éste libro tomara el enfoque opuesto, desarrollando una aplicación completa incrementalmente y explicando cada concepto cuando surja. Pero para un rápido vistazo (y para una gratificación instantanea) no hay substituto para un andamio. El resultado nos dejara interactuar con la aplicación usando URLs, y aparte, nos permitira tener un entendimiento más profundo de la <em>Arquitectura REST</em>, favorecida por Rails.</p>

<p>Ambas aplicaciónes consistiran de <em>usuarios</em> y de sus asociados <em>microposts</em>(así constituyendo una aplicación muy minimalista al estilo Twitter.) Muchos de éstos pasos pareceran magia, pero no hay de que preocuparse: La aplicación final sera bastante similar, y estara construida por completo empezando del<a class="ref" href="static-pages#top">Capítulo &nbsp;3</a>. Por mientras, tengan un poco de paciencia y otro poco de fe; Al fin de éste tutorial tendran un entendimiento más profundo sobre Rails.<p>

<div class="label" id="sec:planning_the_application"></div>


<h2><a id="sec:2.1" href="a-demo-app#sec:planning_the_application" class="heading"><span class="number">2.1</span> Planeando la aplicación</a></h2>

<p>En esta seccion, planearemos el desarrollo nuestra aplicación de demostración. Como vimos en la <a class="ref" href="beginning#sec:the_first_application">Seccion&nbsp;1.2.3</a>, empezaremos por generar un esqueleto usando la orden <code>rails</code>: </p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> <span class="nb">cd</span> ~/rails_projects
<span class="gp">$</span> rails new demo_app
<span class="gp">$</span> <span class="nb">cd </span>demo_app
</pre></div>
</div>

<p>Ahora, usaremos nuestro editor de texto para actualizar el archivo requerido por Bundler llamado <code>Gemfile</code> con el contenido de <a class="ref" href="a-demo-app#code:demo_gemfile_sqlite_version_redux">Listado&nbsp;2.1</a>. </p>

<div class="label" id="code:demo_gemfile_sqlite_version_redux"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.1.</span> <span class="description">El <code>Gemfile</code> para la aplicación demostrativa.</span>
</div>
<div class="code"><div class="highlight"><pre><span class="n">source</span> <span class="s1">&#39;http://rubygems.org&#39;</span>

<span class="n">gem</span> <span class="s1">&#39;rails&#39;</span><span class="p">,</span> <span class="s1">&#39;3.0.7&#39;</span>
<span class="n">gem</span> <span class="s1">&#39;sqlite3-ruby&#39;</span><span class="p">,</span> <span class="s1">&#39;1.3.2&#39;</span><span class="p">,</span> <span class="ss">:require</span> <span class="o">=&gt;</span> <span class="s1">&#39;sqlite3&#39;</span>
</pre></div>
</div></div>

<p>(Si todavia usas OSX Leopard, a lo mejor necesitarás la versión <tt>1.2.5</tt> de la gema <tt>sqlite3-ruby</tt>, como dice en la <a class="ref" href="beginning#sec:bundler">Seccion&nbsp;1.2.4</a>. Luego, instalamos e incluimos las gemas usando <code>bundle</code>:</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> bundle install
</pre></div>
</div>

<p>Finalmente, iniciaremos un repositorio de Git y haremos nuestro primer commit:<sup class="footnote" id="fnref:2.2"><a href="#fn:2.2">2</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> git init
<span class="gp">$</span> git add .
<span class="gp">$</span> git commit -m <span class="s2">&quot;Commit inicial&quot;</span>
</pre></div>
</div>


<div class="label" id="fig:create_demo_repo"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/create_demo_repo.png" alt="create_demo_repo" /></span></div><div class="caption"><span class="header">Figura 2.1: </span><span class="description">Creando un repositorio en GitHub para la aplicación de demo.&nbsp;<a href="http://railstutorial.org/images/figures/create_demo_repo-full.png">(full size)</a></span></div></div>

<p>Opcionalmente, tambien puedes crear un nuevo repositorio (<a class="ref" href="a-demo-app#fig:create_demo_repo">Figure&nbsp;2.1</a>) y subirlo a Github:</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> git remote add origin git@github.com:&lt;username&gt;/demo_app.git
<span class="gp">$</span> git push origin master
</pre></div>
</div>

<p>Ahora estamos listos para empezar a construir nuestra aplicación. El tipico primer paso al crear una nueva applicacion de web es la de construir un <em>modelo de data</em>(data model). Un modelo es una representación de las estructuras requeridas por nuestra aplicación. En nuestro caso, la aplicación demostrativa sera un microblog muy basíco, con solo usuarios y cortos (micro) posts. Primero modelaremos a nuestros <em>usuarios</em>(users) <a class="ref" href="a-demo-app#sec:modeling_users">Seccion&nbsp;2.1.1</a>), y luego, los <em>microposts</em> (<a class="ref" href="a-demo-app#sec:modeling_microposts">Seccion&nbsp;2.1.2</a>).</p>

<div class="label" id="sec:modeling_users"></div>


<h3><a id="sec:2.1.1" href="a-demo-app#sec:modeling_users" class="heading"><span class="number">2.1.1</span> Modelando usuarios</a></h3>

<p>Hay tantas opciones para crear un nuevo modelo de data como hay diferentes formas de registrarse en la web; optaremos por tomar un tono bastante minimalista. Nuestros usuarios tendran un <code>numero</code>(integer) único que ayudara a identificarlos, llamado id, y tambien tendran un nombre publico llamado <code>nombre</code>(de tipo <code>string</code>), usado tambien como un username. El resumen del modelo de usuarios aparece en la <a class="ref" href="a-demo-app#fig:demo_user_model">Figura&nbsp;2.2</a>.</p>

<div class="label" id="fig:demo_user_model"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_user_model.png" alt="demo_user_model" /></span></div><div class="caption"><span class="header">Figure 2.2: </span><span class="description">El modelo de usuarios.</span></div></div>

<p>Empezando en la <a class="ref" href="modeling-and-viewing-users-one#sec:database_migrations">Seccion&nbsp;6.1.1</a>, la etiqueta de <code>usuarios</code>(users) <a class="ref" href="a-demo-app#fig:demo_user_model">Figura&nbsp;2.2</a> corresponde a la <em>tabla</em> en la base de datos, y los atributos de <code>id</code>, <code>name</code>, y <code>email<code> son <em>columnas</em> dentro de la tabla.</p>

<div class="label" id="sec:modeling_microposts"></div>


<h3><a id="sec:2.1.2" href="a-demo-app#sec:modeling_microposts" class="heading"><span class="number">2.1.2</span> Modelando microposts</a></h3>

<p>El modelo de un micropost es aún más simple que el de un usuario: por ejemplo, un micropost solo consiste de un <code>id</code> y un campo de texto (de tipo <code>string</code>) que llamaremos <code>content</code>.<sup class="footnote" id="fnref:2.3"><a href="#fn:2.3">3</a></sup> Pero existe una complicación: tenemos que <em>asociar</em> cada micropost con cada usuario; algo que lograremos al registrar el <code>user_id</code> del usuario cuando aquel escriba un post. Puedes ver el resultado en la <a class="ref" href="a-demo-app#fig:demo_micropost_model">Figura&nbsp;2.3</a>.</p>

<div class="label" id="fig:demo_micropost_model"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_micropost_model.png" alt="demo_micropost_model" /></span></div><div class="caption"><span class="header">Figure 2.3: </span><span class="description">El modelo de los microposts.</span></div></div>

<p>En la <a class="ref" href="a-demo-app#sec:demo_user_has_many_microposts">Sección&nbsp;2.3.3</a> (y más por completo en el <a class="ref" href="user-microposts#top">Capítulo&nbsp;11</a>), veremos como el atributo de <code>user_id</code> ayudara a expresar sutilmente la idea de que un usuario potencialmente puede asociarse con varios microposts.</p>

<div class="label" id="sec:demo_users_resource"></div>


<h2><a id="sec:2.2" href="a-demo-app#sec:demo_users_resource" class="heading"><span class="number">2.2</span> El recurso de Usuarios</a></h2>

<p>Ahora, implementaremos el modelo de usuarios que escribimos en la <a class="ref" href="a-demo-app#sec:modeling_users">sección&nbsp;2.1.1</a>, junto con la interfaz de web de este modelo.
El <em> recurso de usuarios</em> es parte de ésta combinacion, que nos dejará pensar en los usuarios como si fueran objetos; objetos que pueden ser creados, leidos, actualizados, y destruidos por la red via el <a href="http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">protocolo de HTTP</a>.</p>

<p> Como se prometió en la introducción, nuestro recurso de Usuarios sera creado for el generador de andamios, que viene como un estándar con cada project de Rails. El argumento de la orden de andamio - <code>scaffold</code> es la version singular the el nombre de nuestro recurso ( en este caso, <code>User</code>), junto con parametros opcionales para los atributos del modelo: <sup class="footnote" id="fnref:2.4"><a href="#fn:2.4">4</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> rails generate scaffold User name:string email:string
<span class="go">      invoke  active_record</span>
<span class="go">      create    db/migrate/20100615004000_create_users.rb</span>
<span class="go">      create    app/models/user.rb</span>
<span class="go">      invoke    test_unit</span>
<span class="go">      create      test/unit/user_test.rb</span>
<span class="go">      create      test/fixtures/users.yml</span>
<span class="go">       route  resources :users</span>
<span class="go">      invoke  scaffold_controller</span>
<span class="go">      create    app/controllers/users_controller.rb</span>
<span class="go">      invoke    erb</span>
<span class="go">      create      app/views/users</span>
<span class="go">      create      app/views/users/index.html.erb</span>
<span class="go">      create      app/views/users/edit.html.erb</span>
<span class="go">      create      app/views/users/show.html.erb</span>
<span class="go">      create      app/views/users/new.html.erb</span>
<span class="go">      create      app/views/users/_form.html.erb</span>
<span class="go">      invoke    test_unit</span>
<span class="go">      create      test/functional/users_controller_test.rb</span>
<span class="go">      invoke    helper</span>
<span class="go">      create      app/helpers/users_helper.rb</span>
<span class="go">      invoke      test_unit</span>
<span class="go">      create        test/unit/helpers/users_helper_test.rb</span>
<span class="go">      invoke  stylesheets</span>
<span class="go">      create    public/stylesheets/scaffold.css</span>
</pre></div>
</div>

<p>Al incluir <code>name:string</code> y <code>email:string</code>, ordenamos que nuestro modelo de usuario tome la forma mostrada en la <a class="ref" href="a-demo-app#fig:demo_user_model">Figura&nbsp;2.2</a>.  No hay necesidad de incluir un parametro para <code>id</code>; ésta es creada automaticamente por Rails.<sup class="footnote" id="fnref:2.5"><a href="#fn:2.5">5</a></sup>)</p>

<p>Es preciso <em>migrar</em> nuestra base de datos usando <em>Rake</em>(<a class="ref" href="a-demo-app#sidebar:rake">Caja&nbsp;2.1</a>) antes de proceder con nuestra aplicación.</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> rake db:migrate
<span class="go">==  CreateUsers: migrating ====================================================</span>
<span class="go">-- create_table(:users)</span>
<span class="go">   -&gt; 0.0017s</span>
<span class="go">==  CreateUsers: migrated (0.0018s) ===========================================</span>
</pre></div>
</div>

<p>Ésto simplemente actualiza la base de datos con nuestro nuevo modelo de usuarios. Aprenderemos más sobre las emigraciones de base de datos en la <a class="ref" href="modeling-and-viewing-users-one#sec:database_migrations">Seccion&nbsp;6.1.1</a>.</p>

<p>Con esto, podemos correr nuestro servidor de red local using <code>rails s</code>, que es un atajo para correr <code>rails server</code>:</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> rails s
</pre></div>
</div>


<p>El demo esta listo y lo puedes ver en la dirección<a href="http://localhost:3000/"><tt>http://localhost:3000/</tt></a>.</p>

<div class="label" id="sidebar:rake"></div>


<div class="sidebar"><span class="title"><span class="header">Box 2.1.</span><span class="description">Rake</span></span>
<p>En Unix, la utilídad <a href="http://en.wikipedia.org/wiki/Make_(software)"><em>make</em></a> ha jugado un papel muy importante en construir programas ejecutables de source code; más de un hacker ha memorizado esta linea:</p>

<pre class="verbatim">  $ ./configure &amp;&amp; make &amp;&amp; sudo make install</pre>

<p>comunmente usada para compilar código en los sistemas que usan Unix (incluyendo a Linux y Mac OSX).</p>

<p>Rake es <em>Ruby make</em>, es parecida a make, pero escrita en Ruby. Rails emplea Rake extensamente, especialmente para muchas tareas administrativas que son necesarias al desarrollar aplicaciónes de red con bases de datos. La orden <code>rake db:migrate</code> es probablemente la más comun, pero hay muchas otras; puedes ver una lista de tareas de bases de datos usando <code>-T db</code>:</p>

<pre class="verbatim">  $ rake -T db</pre>


<p>Para ver todas las tareas disponbiles de Rake, corre:</p>

<pre class="verbatim">  $ rake -T</pre>

<p>Esta lista puede que sea un poco abrumadora, pero no hay de que preocuparse, ya que no es necesario saberse todas (ni muchas) de estas órdenes. Al fínal de <em>Rails Tutorial</em> sabrás las más importantes.
</div>




<div class="label" id="sec:a_user_tour"></div>


<h3><a id="sec:2.2.1" href="a-demo-app#sec:a_user_tour" class="heading"><span class="number">2.2.1</span> A user tour</a></h3>

<p>Al visitar la raíz de nuestra aplicación, en el url <a href="http://localhost:3000/"><tt>http://localhost:3000/</tt></a>, Rails muestra por defecto la misma página que encontramos en la <a class="ref" href="beginning#fig:riding_rails_3">Fígura&nbsp;1.3</a>, pero al generar el recurso de Usuarios, tambien hemos creado un gran número de páginas que nos permiten manipular a nuestros usuarios. Por ejemplo, la página que entrega un listado de todos los usuarios se encuentra en <a href="http://localhost:3000/users">/users</a>,
y la página que nos permite crear un nuevo usuario se encuentra en <a href="http://localhost:3000/">/users/new</a>.<sup class="footnote" id="fnref:2.6"><a href="#fn:2.6">6</a></sup>. El resto de esta seccion se enfoca a darnos una gíra rapida por las páginas de usuarios. Al proceder, puede que sea util referirse a la <a class="ref" href="a-demo-app#table:user_urls">Tabla&nbsp;2.1</a>, cual muestra como corresponden las páginas a los URLs.</p>

<div class="label" id="table:user_urls"></div>


<div class="table"><div class="center"><table class="tabular"><tr><th class="align_left"><strong>URL</strong></th><th class="align_left"><strong>Accion</strong></th><th class="align_left"><strong>Purpose</strong></th></tr><tr class="top_bar"><td class="align_left"><a href="http://localhost:3000/users"><tt>/users</tt></a></td><td class="align_left"><code>index</code></td><td class="align_left">Página para listar todos los usuarios</td></tr><tr><td class="align_left"><a href="http://localhost:3000/users/1"><tt>/users/1</tt></a></td><td class="align_left"><code>show</code></td><td class="align_left">Página para mostrar un usuario con id <code>1</code></td></tr><tr><td class="align_left"><a href="http://localhost:3000/users/new"><tt>/users/new</tt></a></td><td class="align_left"><code>new</code></td><td class="align_left">Página para crear un nuevo usuario</td></tr><tr><td class="align_left"><a href="http://localhost:3000/users/1/edit"><tt>/users/1/edit</tt></a></td><td class="align_left"><code>edit</code></td><td class="align_left">Página para editar al usuario con id <code>1</code></td></tr></table></div><div class="caption"><span class="header">Tabla 2.1: </span><span class="description">Como corresponden las páginas a los URLs para el recurso de Usuarios.</span></div></div>

<p>Vamos a empezar con la página que muestra todos los usuarios de nuestra aplicación, llamada <a href="http://localhost:3000/users"><tt>index</tt></a>; Inicialmente, no hay ningun usuario, (<a class="ref" href="a-demo-app#fig:demo_blank_user_index_rails_3">Figura&nbsp;2.4</a>).</p>

<div class="label" id="fig:demo_blank_user_index_rails_3"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_blank_user_index_rails_3.png" alt="demo_blank_user_index_rails_3" /></span></div><div class="caption"><span class="header">Figure 2.4: </span><span class="description">La página inicial de nuestro indice para el recurso de usuarios (<a href="http://localhost:3000/users"><tt>/users</tt></a>).&nbsp;<a href="/images/figures/demo_blank_user_index_rails_3-full.png">(full size)</a></span></div></div>

<p>Para crear a un nuevo usuario, visitamos a la página de <a href="http://localhost:3000/users/new"><tt>new</tt></a>, como muestra la <a class="ref" href="a-demo-app#fig:demo_new_user_rails_3">Figura&nbsp;2.5</a>. (En el <a class="ref" href="sign-up#top">Capítulo&nbsp;8</a>, esta se convertira en la página de registro).</p>

<div class="label" id="fig:demo_new_user_rails_3"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_new_user_rails_3.png" alt="demo_new_user_rails_3" /></span></div><div class="caption"><span class="header">Figure 2.5: </span><span class="description">La página para crear a un nuevo usuario (<a href="http://localhost:3000/users/new"><tt>/users/new</tt></a>).&nbsp;<a href="/images/figures/demo_new_user_rails_3-full.png">(full size)</a></span></div></div>

<p>Podemos crear un usuario al registrar un nombre y un email y luego presionar el botón Create. El resultado está en la página <a href="http://localhost:3000/users/1"><tt>show</tt></a>, como muestra la <a class="ref" href="a-demo-app#fig:demo_show_user_rails_3">Figura&nbsp;2.6</a>. ( El mensaje de bienvenida color verde se logro usando un <em>flash</em>, técnica que aprenderos más a fondo en la <a class="ref" href="sign-up#sec:the_flash">Seccion&nbsp;8.3.3</a>.) Es preciso observar que el URL es <a href="http://localhost:3000/users/1"><tt>/users/1</tt></a>; como puedes sospechar, el número <code>1</code> es simplemente el <code>id</code> del usuario, atributo cual proviene de la <a class="ref" href="a-demo-app#fig:demo_user_model">Figura&nbsp;2.2</a>. En la <a class="ref" href="modeling-and-viewing-users-two#sec:better_user_views">Seccion&nbsp;7.3</a>, esta página se convertira en el perfil del usuario.
<div class="label" id="fig:demo_show_user_rails_3"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_show_user_rails_3.png" alt="demo_show_user_rails_3" /></span></div><div class="caption"><span class="header">Figure 2.6: </span><span class="description">La página que muestra a el usuario(<a href="http://localhost:3000/users/1"><tt>/users/1</tt></a>).&nbsp;<a href="/images/figures/demo_show_user_rails_3-full.png">(full size)</a></span></div></div>

<p>Para cambiar la información del usuario, vistamos a la página de <a href="http://localhost:3000/users/1/edit"><tt>edit</tt></a>(<a class="ref" href="a-demo-app#fig:demo_edit_user_rails_3">Figure&nbsp;2.7</a>). Al modificar la información del usuario y presionar el botón de Update, logramos que cambie la información del usuario en nuestro demo. (<a class="ref" href="a-demo-app#fig:demo_update_user_rails_3">Figure&nbsp;2.8</a>). (Veremos esto en detalle en el <a class="ref" href="modeling-and-viewing-users-one#top">Capítulo&nbsp;6</a>, los datos del usuario son guardados en una base de datos.) Añadiremos la función de editar/actualizar la aplicación en la <a class="ref" href="updating-showing-and-deleting-users#sec:updating_users">Seccion&nbsp;10.1</a>.</p>

<div class="label" id="fig:demo_edit_user_rails_3"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_edit_user_rails_3.png" alt="demo_edit_user_rails_3" /></span></div><div class="caption"><span class="header">Figure 2.7: </span><span class="description">The user edit page (<a href="http://localhost:3000/users/1/edit"><tt>/users/1/edit</tt></a>).&nbsp;<a href="/images/figures/demo_edit_user_rails_3-full.png">(full size)</a></span></div></div>




<div class="label" id="fig:demo_update_user_rails_3"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_update_user_rails_3.png" alt="demo_update_user_rails_3" /></span></div><div class="caption"><span class="header">Figure 2.8: </span><span class="description">Un usuario con su informacion actualizada.&nbsp;<a href="/images/figures/demo_update_user_rails_3-full.png">(full size)</a></span></div></div>

<p>Ahora, crearemos a un segundo usuario al revisitar a la página <a href="http://localhost:3000/users/new"><tt>new</tt></a> y registrando un segundo set de datos de usuario; el nuevo usuaro se puede ver en la página <a href="http://localhost:3000/users"><tt>index</tt></a> como se muestra en la <a class="ref" href="a-demo-app#fig:demo_user_index_two_rails_3">Figura&nbsp;2.9</a>. En la <a class="ref" href="updating-showing-and-deleting-users#sec:showing_users">seccion&nbsp;10.3</a> desarrolaremos a nuestro indice de usuarios en una página más pulida en donde mostraremos a todos los usuarios.</p>

<div class="label" id="fig:demo_user_index_two_rails_3"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_user_index_two_rails_3.png" alt="demo_user_index_two_rails_3" /></span></div><div class="caption"><span class="header">Figura 2.9: </span><span class="description">El índice de usuarios (<a href="http://localhost:3000/users"><tt>/users</tt></a>) con un segundo usuario.&nbsp;<a href="/images/figures/demo_user_index_two_rails_3-full.png">(full size)</a></span></div></div>

<p>Al haber visto como crear, mostrar, y editar a un usuario, por fin llegamos a destruirlos (<a class="ref" href="a-demo-app#fig:demo_destroy_user_rails_3">Figura&nbsp;2.10</a>). Deberías verificar que presionado el link en la <a class="ref" href="a-demo-app#fig:demo_destroy_user_rails_3">Figura&nbsp;2.10</a> destruya al segundo usuario, resultando en una página index con un solo usuario. (Si esto no funciona, asegurate que Javascript esté permitido en tu browrser; Rails usa Javascrop para mandar una peticion al browser que destruya el usuario.)<a class="ref" href="updating-showing-and-deleting-users#sec:destroying_users">Seccion&nbsp;10.4</a> añade la funcion de borrar un usuario de la aplicación, tomando cautela de restringir su uso a una clase de usuarios con permisos administrativos.</p>

<div class="label" id="fig:demo_destroy_user_rails_3"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_destroy_user_rails_3.png" alt="demo_destroy_user_rails_3" /></span></div><div class="caption"><span class="header">Figure 2.10: </span><span class="description">Destruyendo a un usuario.&nbsp;<a href="/images/figures/demo_destroy_user_rails_3-full.png">(full size)</a></span></div></div>




<div class="label" id="sec:mvc_in_action"></div>


<h3><a id="sec:2.2.2" href="a-demo-app#sec:mvc_in_action" class="heading"><span class="number">2.2.2</span> MVC en accion</a></h3>

<p>Es preciso examinar una parte del recurso de usuarios antes de seguir al siguiente paso; especialmente su aspecto particular en un contexto de la pauta de Modelo-Vista-Controlador (MVC) introducida en la <a class="ref" href="beginning#sec:mvc">Sección&nbsp;1.2.6</a>. Nuestra estrategia será describir los resultados de un típico hit del browser al visitar nuestro índice de usuarios, localizado en <a href="http://localhost:3000/users">/users</a>&mdash; en terminos de MVC como muestra la (<a class="ref" href="a-demo-app#fig:mvc_detailed">Figura&nbsp;2.11</a>).

<div class="label" id="fig:mvc_detailed"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/mvc_detailed.png" alt="mvc_detailed" /></span></div><div class="caption"><span class="header">Figura 2.11: </span><span class="description">Un diagrama en detalle del MVC en Rails.&nbsp;<a href="/images/figures/mvc_detailed-full.png">(full size)</a></span></div></div>




<ol>
<li>El browser solicita la URL <tt>/users</tt></li>
<li>Rails configura la ruta de <tt>/users</tt> para usar la accion <code>index</code> en el controlador de Usuarios.</li>
<li>La acción <code>index</code> le pide al modelo de Usuario que devuelva todos los usuarios (<code>User.all</code>.</li>
<li>El modelo de Usuario toma a todos los usuarios de la base de datos.</li>
<li>El modelo de Usuario le regresa una lista de todos los usuarios al controlador.</li>
<li>El controlador captura a los usuarios en la variable <code>@users</code>, que luego es pasada a la vista del <code>index</code></li>
<li>La vista usa Embedded Ruby para presentar la página como HTML.</li>
<li>El controlador pasa el HTML de vuelta al browser.<sup class="footnote" id="fnref:2.7"><a href="#fn:2.7">7</a></sup></li>
</ol>

<p>Empezamos con una solicitud del browser, por ejemplo, el resultado de escribir un URL en la barra de navegacion, o el presionar un enlaze (Paso&nbsp;1 en la <a class="ref" href="a-demo-app#fig:mvc_detailed">Figura&nbsp;2.11</a>). Esta petición le llega a las <em>Rutas de Rails</em>. (Paso&nbsp;2), que despachan la petición a la <em>acción correcta del controlador</em> basado en el URL (como veremos en la <a class="ref" href="static-pages#sidebar:get_etc">Caja&nbsp;3.1</a>, el tipo de peticion). El código asígnará los URLs del usuario a las acciones del controlador a las que correspondan, como aparece en <a class="ref" href="a-demo-app#code:rails_routes">Listado&nbsp;2.2</a>; <sup class="footnote" id="fnref:2.8"><a href="#fn:2.8">8</a></sup> Éste código efectivamente plantea una tabla de pares de URL/accion como se muestra en la <a class="ref" href="a-demo-app#table:user_urls">Tabla&nbsp;2.1</a>.</p>

<div class="label" id="code:rails_routes"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.2.</span> <span class="description">Las rutas de Rails, con una regla para el recurso de usuarios. <br /> <code>config/routes.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="no">DemoApp</span><span class="o">::</span><span class="no">Application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:users</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div>
</div></div>

<p>Las páginas del tour en la <a class="ref" href="a-demo-app#sec:a_user_tour">Seccion&nbsp;2.2.1</a> le corresponden a las <em>acciones</em> que se encuentran el <em>controlador</em> de Usuarios, una collecion de acciones relacionadas; el controlador de usuarios fue generado por el andamio de usuarios y se muestra esquematicamente en el <a class="ref" href="a-demo-app#code:demo_users_controller">Listado&nbsp;2.3</a>. Observa la anotación <code>class UsersController &lt; ApplicationController</code>; éste ejemplo es de una <em>clase</em> de Ruby con <em>herencia</em>. (Discutiremos brevamente sobre este concepto en la <a class="ref" href="a-demo-app#sec:inheritance_hierarchies">Seccion&nbsp;2.3.4</a> y lo cubriremos en más detalle en la <a class="ref" href="rails-flavored-ruby#sec:ruby_classes">Seccion&nbsp;4.4</a>.)</p>

<div class="label" id="code:demo_users_controller"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.3.</span> <span class="description">El controlador de usuarios en forma esquematica.<br /> <code>app/controllers/users_controller.rb</code></span>
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">index</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">new</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">create</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">edit</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">update</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">destroy</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div></div>

<p>Podrás ver como las acciones de estas páginas; el <code>index</code>, <code>show</code>, <code>new</code>, y <code>edit</code> corresponden a páginas de la <a class="ref" href="a-demo-app#sec:a_user_tour">sección&nbsp;2.2.1</a>, pero también se encuentran unas más: <code>create</code>, <code>update</code>, y <code>destroy</code>. Estas acciones normalmente no devuelven páginas (aunque a veces sí lo hacen); en lugar de eso, su proposito principal es el de moficiar la infomación sobre los usuarios en la base de datos. Este juego de acciones del controlador, resumido en la <a class="ref" href="a-demo-app#table:demo_RESTful_users">Tabla&nbsp;2.2</a>, representa la implementación de la arquitectura REST en Rails (<a class="ref" href="a-demo-app#sidebar:REST">Box&nbsp;2.2</a>). En la <a class="ref" href="a-demo-app#table:demo_RESTful_users">Tabla&nbsp;2.2</a> se puede observar que algunos URLs coinciden parcialmente; por ejemplo, ambas las acciones de <code>show</code> y de <code>update</code> para usuarios corresponden al URL <tt>/users/1</tt>. La diferencia entre ellos es que responden a differentes <a href="http://en.wikipedia.org/wiki/HTTP_request#Request_methods">metodos de peticion de HTTP.</a>Aprenderemos más sobre los metodos de peticion de HTTP en la <a class="ref" href="static-pages#sec:TDD">sección&nbsp;3.2.2</a>.</p>

<div class="label" id="table:demo_RESTful_users"></div>


<div class="table"><div class="center"><table class="tabular"><tr><th class="align_left"><strong>Petición HTTP</strong></th><th class="align_left"><strong>URL</strong></th><th class="align_left"><strong>Acción</strong></th><th class="align_left"><strong>Propósito</strong></th></tr><tr class="top_bar"><td class="align_left"><tt>GET</tt></td><td class="align_left"><tt>/users</tt></td><td class="align_left"><code>index</code></td><td class="align_left">página para listar todos los usuarios</td></tr><tr><td class="align_left"><tt>GET</tt></td><td class="align_left"><tt>/users/1</tt></td><td class="align_left"><code>show</code></td><td class="align_left">página para mostrar al usuario con id <code>1</code></td></tr><tr><td class="align_left"><tt>GET</tt></td><td class="align_left"><tt>/users/new</tt></td><td class="align_left"><code>new</code></td><td class="align_left">página para crear un nuevo usuario</td></tr><tr><td class="align_left"><tt>POST</tt></td><td class="align_left"><tt>/users</tt></td><td class="align_left"><code>create</code></td><td class="align_left">crear un nuevo usuario</td></tr><tr><td class="align_left"><tt>GET</tt></td><td class="align_left"><tt>/users/1/edit</tt></td><td class="align_left"><code>edit</code></td><td class="align_left">página para editar al usuario con id <code>1</code></td></tr><tr><td class="align_left"><tt>PUT</tt></td><td class="align_left"><tt>/users/1</tt></td><td class="align_left"><code>update</code></td><td class="align_left">actualizar al usuario con id <code>1</code></td></tr><tr><td class="align_left"><tt>DELETE</tt></td><td class="align_left"><tt>/users/1</tt></td><td class="align_left"><code>destroy</code></td><td class="align_left">borrar usuario con id <code>1</code></td></tr></table></div><div class="caption"><span class="header">Table 2.2: </span><span class="description">Rutas RESTful que entrega el recurso de Usuarios en el <a class="ref" href="a-demo-app#code:rails_routes">Listado&nbsp;2.2</a>.</span></div></div>




<div class="label" id="sidebar:REST"></div>


<div class="sidebar"><span class="title"><span class="header">Box 2.2.</span><span class="description">REpresentational State Transfer (REST)</span></span>
<p>Si lees mucho acerca del desarrolo en red con Ruby on Rails, veras muchas referencias a &ldquo;REST&rdquo;, una sigla para el REpresentational State Transfer. REST es un estilo arquitectural para desarrolar sistemas y aplicaciónes distribuidas y conectadas a la red, para la World Wide Web. Aunque la teoria de REST es bastante abstracta, en un contexto de Rails esto significa que la mayoria de los componentes de la aplicación ( como los usuarios y los microposts) son modelados como <em>recursos</em> que pueden ser creados, leidos, actualizados, y destruidos con operaciones que corresponden a las <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">operaciones relacionales CRUD de la base de datos</a> y a los cuatro <a href="http://en.wikipedia.org/wiki/HTTP_request#Request_methods">metodos fundamentales de peticion HTTP</a>: <tt>POST</tt>, <tt>GET</tt>, <tt>PUT</tt>, y <tt>DELETE</tt>. (Aprenderemos más sobre las peticiones de HTTP en la <a class="ref" href="static-pages#sec:TDD">seccion&nbsp;3.2.2</a> y especialmente en la <a class="ref" href="static-pages#sidebar:get_etc">Caja&nbsp;3.1</a>.)</p>

<p>Como un desarrolador de Rails, el estilo REST te ayuda a hacer decisiones acerca de que controladores y que acciones que escribir: simplemente construyes una estructura para la aplicación usando recursos que son creados, leidos, actualizados, y borrados. En el caso de nuestros usarios y microposts, este proceso es sencillo, ya que son recursos naturales en su propio derecho. En el <a class="ref" href="following-users#top">Capítulo&nbsp;12</a>, veremos un ejemplo de los principios de REST, que nos ayudará a modelar un problema más sutil, como seguir a usuarios, de una manera más natural y conveniente.</p>
</div>

<p>Para ver la relación entre el controlador de Usuarios y el modelo de Usuario, es preciso enfocarnos en una version más simple de la accion <code>index</code>, expuesta en <a class="ref" href="a-demo-app#code:demo_index_action">Listado&nbsp;2.4</a>.<sup class="footnote" id="fnref:2.9"><a href="#fn:2.9">9</a></sup></p>

<div class="label" id="code:demo_index_action"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.4.</span> <span class="description">La acción de índice (<code>index</code>) simplificada para user de la aplicación de muestra. <br /><code>app/controllers/users_controller.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">index</span>
  <span class="vi">@users</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">all</span>
  <span class="k">end</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="k">end</span>
</pre></div>
</div></div>

<p>Esta acción <code>index</code> usa la linea <code>@users = User.all</code>  (Paso&nbsp;3), la que obtiene una lista de usuarios desde la base de datos (Paso&nbsp;4),, y luego los asígna a un variable <code>@users</code> (pronunciada &ldquo;at-users&rdquo;) (Paso&nbsp;5). El modelo de Usuario en si aparece en <a class="ref" href="a-demo-app#code:demo_user_model">Listado&nbsp;2.5</a>; aunque está algo incompleto, está equipado con bastante funcionalidad gracias a su herencia (<a class="ref" href="a-demo-app#sec:inheritance_hierarchies">Section&nbsp;2.3.4</a> y <a class="ref" href="rails-flavored-ruby#sec:ruby_classes">Section&nbsp;4.4</a>). En particular, al usar la biblioteca de Rails llamada <em>Active Record</em>, el código en <a class="ref" href="a-demo-app#code:demo_user_model">Listado&nbsp;2.5</a> asígna que <code>User.all</code> devuelva todos los usuarios.</p>

<div class="label" id="code:demo_user_model"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.5.</span> <span class="description">El modelo de Usuario para la aplicación de demostracion. <br /> <code>app/models/user.rb</code></span>
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
<span class="k">end</span>
</pre></div>
</div></div>


<p>Una vez que se define la variable <code>@users</code>, el controlador llama a la <em>vista</em> (Paso&nbsp;6), mostrada en <a class="ref" href="a-demo-app#code:demo_index_view">Listado&nbsp;2.6</a>. Las variables que empiezen con el símbolo <code>@</code>, son llamadas <em>variables de instancia</em>, y se encuentran automaticamente disponibles a la vista; en este caso, la vista <code>index.html.erb</code> en <a class="ref" href="a-demo-app#code:demo_index_view">Listado&nbsp;2.6</a> itera por la lista de <code>@users</code> y rinde una linea de HTML por cada una. <sup class="footnote" id="fnref:2.10"><a href="#fn:2.10">10</a></sup></p>

<div class="label" id="code:demo_index_view"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.6.</span> <span class="description"> La vista del indice de usuarios(No es preciso entenderlo ahora)<br /> <code>app/views/users/index.html.erb</code></span>
</div>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>Listado users<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;table&gt;</span>
  <span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;th&gt;</span>Name<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;th&gt;</span>Email<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;th&gt;&lt;/th&gt;</span>
    <span class="nt">&lt;th&gt;&lt;/th&gt;</span>
    <span class="nt">&lt;th&gt;&lt;/th&gt;</span>
  <span class="nt">&lt;/tr&gt;</span>

<span class="cp">&lt;%</span> <span class="vi">@users</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">user</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">user</span><span class="o">.</span><span class="n">email</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">&#39;Show&#39;</span><span class="p">,</span> <span class="n">user</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">&#39;Edit&#39;</span><span class="p">,</span> <span class="n">edit_user_path</span><span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">&#39;Destroy&#39;</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="ss">:confirm</span> <span class="o">=&gt;</span> <span class="s1">&#39;Are you sure?&#39;</span><span class="p">,</span>
<span class="ss">:method</span> <span class="o">=&gt;</span> <span class="ss">:delete</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
  <span class="nt">&lt;/tr&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;/table&gt;</span>

<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>

<span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">&#39;New User&#39;</span><span class="p">,</span> <span class="n">new_user_path</span> <span class="cp">%&gt;</span>
</pre></div>
</div></div>

<p>Esta vista convierte el contenido a HTML (Paso&nbsp;7), el cual luego es regresado por el controlador al browser para ser mostrado (Paso&nbsp;8).</p>

<div class="label" id="sec:weaknesses_of_this_users_resource"></div>


<h3><a id="sec:2.2.3" href="a-demo-app#sec:weaknesses_of_this_users_resource" class="heading"><span class="number">2.2.3</span> Debilidades de éste recurso de Usuarios</a></h3>

<p>Aunque el andamio de Usuarios es útil para obtener una visión general de Rails, el recurso sufre de varias debilidades bastante severas:</p>

<ul>
<li><strong>No se validan los datos.</strong>El modelo de Usuario accepta datos como nombres en blanco y correos electronicos con un formato invalido sin ninguna queja.</li>
<li><strong>No hay autenticación.</strong>No hay como registrar sesiones, y no hay manera de evitar que un usuario suplante a otro.</li>
<li><strong>No hay tests.</strong>Esto no es todo de por cierto, ya que el andamio incluye pruebas rudimentarias, pero las pruebas generadas son feas e inflexibles, y no prueban validaciondes de data, autenticacion, o otros requerimientos a medida.</li>
<li><strong>No tiene composición.</strong>No existe un diseño en la página, o algun tipo de navegación.</li>
<li><strong>No hay un conocimiento muy profundo.</strong>Si entiendes el código de andamio, problabemente no deberías estar leyendo este libro.</li>
</ul>

<div class="label" id="sec:microposts_resource"></div>

<h2><a id="sec:2.3" href="a-demo-app#sec:microposts_resource" class="heading"><span class="number">2.3</span>El recurso de Microposts</a></h2>

<p>Habiendo generado y explorado el recurso de usuarios, ahora veremos el relacionado recurso de Microposts. Durante esta sección, recomiendo comparar los elementos del recurso de Micriposts con sus elementos analogos al de los usuarios de la <a class="ref" href="a-demo-app#sec:demo_users_resource">seccion&nbsp;2.2</a>; donde podras ver que los dos recursos son paralelos en muchas otras maneras. La estructura REST de las aplicaciónes de Rails es mejor absorbida con este tipo de repeticion de forma; en efecto, ver la estructura paralela de los Usuarios y Microposts aun en esta etapa es una de las principlaces motivaciones de este capítulo. ( Como veremos despues, escribir aplicaciónes más robustas toma un esfuerzo considerable. No evermos al recurso de microposts de nuevo hasta el <a class="ref" href="user-microposts#top">Capítulo&nbsp;11</a>&mdash; y no quise diferir su presencia hasta ese extremo).</p>

<div class="label" id="sec:a_micropost_microtour"></div>


<h3><a id="sec:2.3.1" href="a-demo-app#sec:a_micropost_microtour" class="heading"><span class="number">2.3.1</span> Un microtour de Microposts</a></h3>

<p>Así como hicimos con el recurso de Usuarios, generaremos un andamio de Microropost usando <code>rails generate scaffold</code>, en este caso implementando el modelo de datos de la <a class="ref" href="a-demo-app#fig:demo_micropost_model">Figura&nbsp;2.3</a>:<sup class="footnote" id="fnref:2.11"><a href="#fn:2.11">11</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> rails generate scaffold Micropost content:string user_id:integer
<span class="go">      invoke  active_record</span>
<span class="go">      create    db/migrate/20100615004429_create_microposts.rb</span>
<span class="go">      create    app/models/micropost.rb</span>
<span class="go">      invoke    test_unit</span>
<span class="go">      create      test/unit/micropost_test.rb</span>
<span class="go">      create      test/fixtures/microposts.yml</span>
<span class="go">       route  resources :microposts</span>
<span class="go">      invoke  scaffold_controller</span>
<span class="go">      create    app/controllers/microposts_controller.rb</span>
<span class="go">      invoke    erb</span>
<span class="go">      create      app/views/microposts</span>
<span class="go">      create      app/views/microposts/index.html.erb</span>
<span class="go">      create      app/views/microposts/edit.html.erb</span>
<span class="go">      create      app/views/microposts/show.html.erb</span>
<span class="go">      create      app/views/microposts/new.html.erb</span>
<span class="go">      create      app/views/microposts/_form.html.erb</span>
<span class="go">      invoke    test_unit</span>
<span class="go">      create      test/functional/microposts_controller_test.rb</span>
<span class="go">      invoke    helper</span>
<span class="go">      create      app/helpers/microposts_helper.rb</span>
<span class="go">      invoke      test_unit</span>
<span class="go">      create        test/unit/helpers/microposts_helper_test.rb</span>
<span class="go">      invoke  stylesheets</span>
<span class="go">   identical    public/stylesheets/scaffold.css</span>
</pre></div>
</div>

<p>Para actualizar nuestra base de datos con el nuevo modelo, debemos corren una migración como muestra la <a class="ref" href="a-demo-app#sec:demo_users_resource">Section&nbsp;2.2</a>:</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> rake db:migrate
<span class="go">==  CreateMicroposts: migrating ===============================================</span>
<span class="go">-- create_table(:microposts)</span>
<span class="go">   -&gt; 0.0023s</span>
<span class="go">==  CreateMicroposts: migrated (0.0026s) ======================================</span>
</pre></div>
</div>

<p>Ahora estamos en una mejor posicion para crear microposts de la misma manera en la que construmos usarios en la <a class="ref" href="a-demo-app#sec:a_user_tour">Section&nbsp;2.2.1</a>. El generador de andamios a actualizado las rutas de Rails con una regla para el recurso de microposts, así como muestra el <a class="ref" href="a-demo-app#code:demo_microposts_resource">Listado&nbsp;2.7</a>.<sup class="footnote" id="fnref:2.12"><a href="#fn:2.12">12</a></sup> As with users, the <code>resources :microposts</code> routing rule maps a micropost URLs to actions in the Microposts controller, as seen in <a class="ref" href="a-demo-app#table:demo_RESTful_microposts">Table&nbsp;2.3</a>.</p>

<div class="label" id="code:demo_microposts_resource"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.7.</span> <span class="description">Las rutas de Rails, con una nueva regla para el recurso de Microposts.<br /> <code>config/routes.rb</code></span>
</div>
<div class="code"><div class="highlight"><pre><span class="no">DemoApp</span><span class="o">::</span><span class="no">Application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:microposts</span>
  <span class="n">resources</span> <span class="ss">:users</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div>
</div></div>




<div class="label" id="table:demo_RESTful_microposts"></div>


<div class="table"><div class="center"><table class="tabular"><tr><th class="align_left"><strong>HTTP request</strong></th><th class="align_left"><strong>URL</strong></th><th class="align_left"><strong>Action</strong></th><th class="align_left"><strong>Purpose</strong></th></tr><tr class="top_bar"><td class="align_left"><tt>GET</tt></td><td class="align_left"><tt>/microposts</tt></td><td class="align_left"><code>index</code></td><td class="align_left">page to list all microposts</td></tr><tr><td class="align_left"><tt>GET</tt></td><td class="align_left"><tt>/microposts/1</tt></td><td class="align_left"><code>show</code></td><td class="align_left">page to show micropost with id <code>1</code></td></tr><tr><td class="align_left"><tt>GET</tt></td><td class="align_left"><tt>/microposts/new</tt></td><td class="align_left"><code>new</code></td><td class="align_left">page to make a new micropost</td></tr><tr><td class="align_left"><tt>POST</tt></td><td class="align_left"><tt>/microposts</tt></td><td class="align_left"><code>create</code></td><td class="align_left">create a new micropost</td></tr><tr><td class="align_left"><tt>GET</tt></td><td class="align_left"><tt>/microposts/1/edit</tt></td><td class="align_left"><code>edit</code></td><td class="align_left">page to edit micropost with id <code>1</code></td></tr><tr><td class="align_left"><tt>PUT</tt></td><td class="align_left"><tt>/microposts/1</tt></td><td class="align_left"><code>update</code></td><td class="align_left">update micropost with id <code>1</code></td></tr><tr><td class="align_left"><tt>DELETE</tt></td><td class="align_left"><tt>/microposts/1</tt></td><td class="align_left"><code>destroy</code></td><td class="align_left">delete micropost with id <code>1</code></td></tr></table></div><div class="caption"><span class="header">Table 2.3: </span><span class="description">RESTful routes provided by the Microposts resource in <a class="ref" href="a-demo-app#code:demo_microposts_resource">Listado&nbsp;2.7</a>.</span></div></div>

<p>El controlador de Microposts se encuentra en forma esquematica en <a class="ref" href="a-demo-app#code:demo_microposts_controller">Listado&nbsp;2.8</a>. Aparte de tener un <code>MicropostsController</code> en lugar de un <code>UsersController</code></p>, <a class="ref" href="a-demo-app#code:demo_microposts_controller">Listado&nbsp;2.8</a> es <em>identico</em> al codgio en <a class="ref" href="a-demo-app#code:demo_users_controller">Listado&nbsp;2.3</a>. Esa es una reflexion de la arquitectura common de los recursos, REST.

<div class="label" id="code:demo_microposts_controller"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.8.</span> <span class="description">El controlador de Microposts en forma esquematica. <br /> <code>app/controllers/microposts_controller.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MicropostsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">index</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">new</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">create</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">edit</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">update</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">destroy</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div></div>

<p>En orden de crear microposts, debemos de entrar la informacion en la página de nuevos microposts, <a href="http://localhost:3000/microposts/new">/microposts/new</a>, como muestra la <a class="ref" href="a-demo-app#fig:demo_new_micropost_rails_3">Figura&nbsp;2.12</a>.</p>


<div class="label" id="fig:demo_new_micropost_rails_3"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_new_micropost_rails_3.png" alt="demo_new_micropost_rails_3" /></span></div><div class="caption"><span class="header">Figure 2.12: </span><span class="description">The new micropost page (<a href="http://localhost:3000/microposts/new">/microposts/new</a>).&nbsp;<a href="http://railstutorial.org/images/figures/demo_new_micropost-full.png">(full size)</a></span></div></div>

<p>En este momento, crea un nuevo micropost o dos, tomando en cuenta que por lo menos uno tenga un <code>user_id</code> de <code>1</code> para igualar al id del primer usuario que fue creado en la <a class="ref" href="a-demo-app#sec:a_user_tour">Section&nbsp;2.2.1</a>. El resultado se deveria de ver algo parecido a la <a class="ref" href="a-demo-app#fig:demo_micropost_index_rails_3">Figura&nbsp;2.13</a>.</p>

<div class="label" id="fig:demo_micropost_index_rails_3"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_micropost_index_rails_3.png" alt="demo_micropost_index_rails_3" /></span></div><div class="caption"><span class="header">Figure 2.13: </span><span class="description">The micropost index page (<a href="http://localhost:3000/microposts">/microposts</a>).&nbsp;<a href="http://railstutorial.org/images/figures/demo_micropost_index_rails_3-full.png">(full size)</a></span></div></div>




<div class="label" id="sec:putting_the_micro_in_microposts"></div>


<h3><a id="sec:2.3.2" href="a-demo-app#sec:putting_the_micro_in_microposts" class="heading"><span class="number">2.3.2</span> Poniendo el "micro" en "microposts".</a></h3>

<p>Cualquier <em>micro</em>post que sea digno de ese nombre tiene que tener alguna manera de asegurar el tamaño del post. Implementar esta restricción es facil en Rails usando <em>validaciones</em>; para acceptar microposts con un maximo de 140 letras ( á la Twitter), usamos la validacion de <em>length</em>. En este punto, deverias de abrir el archivo <code>app/models/micropost.rb</code> en tu editor de texto o IDE y llenarla con el contenido de <a class="ref" href="a-demo-app#code:demo_length_validation">Listado&nbsp;2.9</a>. (El uso del código <code>validates</code> en el <a class="ref" href="a-demo-app#code:demo_length_validation">Listado&nbsp;2.9</a> es cáracteristico de Rails 3; si has trabajado antes con Rails 2.4, deverias de comparar el uso de <code>validates_length_of</code>.)</p>

<div class="label" id="code:demo_length_validation"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.9.</span> <span class="description">Restringiendo microposts un maximo de 140 cáracters con la validacion. <br /> <code>app/models/micropost.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Micropost</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">validates</span> <span class="ss">:content</span><span class="p">,</span> <span class="ss">:length</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:maximum</span> <span class="o">=&gt;</span> <span class="mi">140</span> <span class="p">}</span>
<span class="k">end</span>
</pre></div>
</div></div>

<p>El código que se encuentra en <a class="ref" href="a-demo-app#code:demo_length_validation">Listado&nbsp;2.9</a>  puede paracer un poco cryptico, pero cubrimeros más acerca de las validaciones más por completo empezando con la <a class="ref" href="modeling-and-viewing-users-one#sec:user_validations">Section&nbsp;6.2</a> pero sus efectos seran obvios si construimos un nuevo micropost con más de 140 letras, como se muestra en la <a class="ref" href="a-demo-app#fig:micropost_length_error_rails_3">Figure&nbsp;2.14</a>, Rails renders <em>error messages</em> indicating that the micropost&rsquo;s content is too long. (We&rsquo;ll learn more about error messages in <a class="ref" href="sign-up#sec:signup_error_messages">Section&nbsp;8.2.3</a>.)</p>

<div class="label" id="fig:micropost_length_error_rails_3"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/micropost_length_error_rails_3.png" alt="micropost_length_error_rails_3" /></span></div><div class="caption"><span class="header">Figure 2.14: </span><span class="description">Los mensajes de errores despues de un intento fallado al crear un micropost. &nbsp;<a href="http://railstutorial.org/images/figures/micropost_length_error_rails_3-full.png">(full size)</a></span></div></div>




<div class="label" id="sec:demo_user_has_many_microposts"></div>


<h3><a id="sec:2.3.3" href="a-demo-app#sec:demo_user_has_many_microposts" class="heading"><span class="number">2.3.3</span> Un Usuario <code>has_many</code> microposts</a></h3>

<p>Una de las características más poderosas de Rails es la habilidad de formar associanes entre diferentes modelos de datos. Como es el caso en nuestro modelo de Usuario, cada usuario tiene el potencial de tener muchos microposts. Podemos expresar esta idea al actualizar los modelos de User y Micropost como se muestra en <a class="ref" href="a-demo-app#code:demo_user_has_many_microposts">Listado&nbsp;2.10</a> and <a class="ref" href="a-demo-app#code:demo_micropost_belongs_to_user">Listado&nbsp;2.11</a>.</p>

<div class="label" id="code:demo_user_has_many_microposts"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.10.</span> <span class="description">Un usuario tiene muchos microposts. <br /> <code>app/models/user.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">has_many</span> <span class="ss">:microposts</span>
<span class="k">end</span>
</pre></div>
</div></div>




<div class="label" id="code:demo_micropost_belongs_to_user"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.11.</span> <span class="description">Un micropost pertenece a un usuario.<br /> <code>app/models/micropost.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Micropost</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:user</span>

  <span class="n">validates</span> <span class="ss">:content</span><span class="p">,</span> <span class="ss">:length</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="ss">:maximum</span> <span class="o">=&gt;</span> <span class="mi">140</span> <span class="p">}</span>
<span class="k">end</span>
</pre></div>
</div></div>

<p>Podemos visualizar el resultado de esta asociación en la <a class="ref" href="a-demo-app#fig:micropost_user_association">Figure&nbsp;2.15</a>. Porque la columna de <code>user_id</code> existe en la tabla de <code>microposts</code>, Rails (usando Active Record) infiere que los microposts estan asociados con cada usuario.</p>

<div class="label" id="fig:micropost_user_association"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/micropost_user_association.png" alt="micropost_user_association" /></span></div><div class="caption"><span class="header">Figure 2.15: </span><span class="description">La asociacion entre los microposts y usuarios. </span></div></div>

<p>En el <a class="ref" href="user-microposts#top">Capítulo&nbsp;11</a> y el <a class="ref" href="following-users#top">Chapter&nbsp;12</a>, podermos ver que en la asociación de usuarios y microposts, ambos muestran todos los micropost de un usuario y construyen un suministro ("feed") de microposts como el de Twitter. Por mientras, podemos ver las implicaciones que la asociacion entre usuarios-y-microposts al usar la <em>consola</em>, que es una herramienta util para interactuar con nuestras aplicaciónes de Rails. Primero, se invoca a la consola con <code>rails console</code> en la terminal, y luego se recupera del primer usuario en la base de datos usando <code>User.first</code> (asígnando los resultados al variable <code>first_user</code>): <sup class="footnote" id="fnref:2.13"><a href="#fn:2.13">13</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="go">$ rails console</span>
<span class="gp">&gt;&gt; </span><span class="n">first_user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">first</span>
<span class="go">=&gt; #&lt;User id: 1, name: &quot;Michael Hartl&quot;, email: &quot;michael@example.org&quot;,</span>
<span class="go">created_at: &quot;2010-04-03 02:01:31&quot;, updated_at: &quot;2010-04-03 02:01:31&quot;&gt;</span>
<span class="gp">&gt;&gt; </span><span class="n">first_user</span><span class="o">.</span><span class="n">microposts</span>
<span class="go">=&gt; [#&lt;Micropost id: 1, content: &quot;First micropost!&quot;, user_id: 1, created_at:</span>
<span class="go">&quot;2010-04-03 02:37:37&quot;, updated_at: &quot;2010-04-03 02:37:37&quot;&gt;, #&lt;Micropost id: 2,</span>
<span class="go">content: &quot;Second micropost&quot;, user_id: 1, created_at: &quot;2010-04-03 02:38:54&quot;,</span>
<span class="go">updated_at: &quot;2010-04-03 02:38:54&quot;&gt;]</span>
<span class="gp">&gt;&gt; </span><span class="nb">exit</span>
</pre></div>
</div>

<p>(He incluido esa última línea para mostrar como salir de la consola, además en muchos sistemas puedes usar Ctrl-d para ese mismo propósito.) Aquí hemos accedido a los micropost del usuario usando el código <code>first_user.microposts</code>: con este código, ActiveRecord automaticamente regresa todos los microposts con un <code>user id</code> igual al id del <code>first_user</code>(en este caso, <code>1</code>). Aprenderemos más sobre las facilidades de asociacion de Active Record en los <a class="ref" href="user-microposts#top">Capítulo&nbsp;11</a> y <a class="ref" href="following-users#top">Capítulo&nbsp;12</a>.</p>

<div class="label" id="sec:inheritance_hierarchies"></div>


<h3><a id="sec:2.3.4" href="a-demo-app#sec:inheritance_hierarchies" class="heading"><span class="number">2.3.4</span> La jerarquía de Herencias </a></h3>

<p>Terminamos nuestra discusión de la aplicación demo con una breve descripción de la jerarquia de herencia en el controlador y el modelo que ejerce Rails. Esta discusión sólo tendrá sentido si tienes experienca con programación orientada a objectos (OOP). Si no has estudiado ya OOP, puedes saltarte esta seccion. En particular, si el concepto de <em>clases</em> (discutidas en <a class="ref" href="rails-flavored-ruby#sec:ruby_classes">Section&nbsp;4.4</a>), no te es familiar, sugiero regresar a esta seccion más adelante</p>

<p>Empezamos con la estrutura de herencia en los modelos. Al comparar el <a class="ref" href="a-demo-app#code:demo_user_class">Listado&nasp;2.12</a> y <a class="ref" href="a-demo-app#code:demo_micropost_class">Listado&nbsp;2.13</a>, podemos ver que ambos los modelos de Usuario y de Micropost heredan (gracias el símbolo de "menor que" &nbsp;<code>&lt;</code>) de <code>ActiveRecord::Base</code>, que es la clase base para los modelos que provienen de ActiveRecord; este diagrama resume estas relaciones <a class="ref" href="a-demo-app#fig:demo_model_inheritance">Figura&nbsp;2.16</a>. Es a traves de heredar de <code>ActiveRecord::Base</code> que nuestro modelos toman la habilidad de comunicarse con la base de datos, que traten a las columnas de la tabla como atributos de Ruby, y así.</p>

<div class="label" id="code:demo_user_class"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.12.</span> <span class="description">La clase de usuarios, con herencia.<br /> <code>app/models/user.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div>
</div></div>




<div class="label" id="code:demo_micropost_class"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.13.</span> <span class="description">La clase de <code>Micropost</code>, with inheritance. <br /> <code>app/models/micropost.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Micropost</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div>
</div></div>




<div class="label" id="fig:demo_model_inheritance"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_model_inheritance.png" alt="demo_model_inheritance" /></span></div><div class="caption"><span class="header">Figura 2.16: </span><span class="description">El modelo de herencia para los modelos User y Micropost.</span></div></div>

<p>La herencia de los controladores es sólo un poco más complicada. Comparando el <a class="ref" href="a-demo-app#code:demo_users_controller_class">Listado&nbsp;2.14</a> con <a class="ref" href="a-demo-app#code:demo_microposts_controller_class">Listado&nbsp;2.15</a>, podemos ver que ambos los controladores de Usuarios y de Microposts heredan del controlador de Aplicación. Más a fondo, <a class="ref" href="a-demo-app#code:demo_application_controller_class">Listado&nbsp;2.16</a>, nos damos cuenta que <code>ApplicationController</code> hereda de <code>ActionController::Base</code></p>

<div class="label" id="code:demo_users_controller_class"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.14.</span> <span class="description">La clase <code>UsersController</code>, con herencia. <br /> <code>app/controllers/users_controller.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div>
</div></div>




<div class="label" id="code:demo_microposts_controller_class"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.15.</span> <span class="description">La clase <code>MicropostsController</code>, con herencia. <br /> <code>app/controllers/microposts_controller.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MicropostsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div>
</div></div>




<div class="label" id="code:demo_application_controller_class"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listado 2.16.</span> <span class="description">La clase de <code>ApplicationController</code>, con herencia. <br /> <code>app/controllers/application_controller.rb</code></span>       
</div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div>
</div></div>




<div class="label" id="fig:demo_controller_inheritance"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="/images/figures/demo_controller_inheritance.png" alt="demo_controller_inheritance" /></span></div><div class="caption"><span class="header">Figure 2.17: </span><span class="description">The inheritance hierarchy for the Users and Microposts controllers.</span></div></div>

<p>Así como con la herencia del modelo, al heredar de <code>ActionController::Base</code>, ambos controladores de Usuarios y Micrpost toman bastante funcionalidad, así como la capacidad de manipular los modelos, filtrar las peticiones de HTTP, y regresar vistas como HTML. Como todos los controladores de rails heredan de <code>ApplicationController</code>, las reglas definidas en Application controller automaticamente se aplican a todas las acciones de la aplicación. Por ejemplo, en <a class="ref" href="sign-up#sec:filtering_parameter_logging">Section&nbsp;8.2.4</a>, vemos como se define una regla en el controlador de aplicación que nos permite filtrar passowrds de todos las archivos en el log, así evitando un riesgo de seguridad.</p>

<div class="label" id="sec:deploying_the_demo_app"></div>


<h3><a id="sec:2.3.5" href="a-demo-app#sec:deploying_the_demo_app" class="heading"><span class="number">2.3.5</span> Deploying the demo app</a></h3>

<p>Al completar el recurso de Microposts, es un buen momento para subir el repositorio a Github:<sup class="footnote" id="fnref:2.14"><a href="#fn:2.14">14</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> git add .
<span class="gp">$</span> git commit -a -m <span class="s2">&quot;Done with the demo app&quot;</span>
<span class="gp">$</span> git push
</pre></div>
</div>


<p>Aparte, puedes subir la aplicación demo a Heroku:</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> heroku create
<span class="gp">$</span> git push heroku master
<span class="gp">$</span> heroku rake db:migrate
</pre></div>
</div>

<p>(So esto no funciona, intenta este posible arreglo, justo arriva de <a class="ref" href="beginning#code:gemfile_sqlite_heroku">Listado&nbsp;1.8</a>) En esta ultima linea se corren las migraciones de la base de datos en Heroku. Ésto actualiza el servidor y la base de datos de Heroku con los modelos de user/micropost. Si quieres subir los <em>datos</em> tambien, puedes hacerlo usando la gema <tt>taps</tt> y con <code>db:push</code>:</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> <span class="o">[</span>sudo<span class="o">]</span> gem install taps
<span class="gp">$</span> heroku db:push
</pre></div>
</div>




<h2><a id="sec:2.4" href="a-demo-app#sec:2.4" class="heading"><span class="number">2.4</span> Conclusion</a></h2>

<p>Hemos llegando ahora al final de nuestro recorrido por Rails. El demo que desarrollamos en este capítulo tiene varios puntos fuertes y un buen numero de puntos debiles.<br /></p>

<p><strong>Puntos Fuertes</strong></p>

<ul>
<li>Una vision general de Rails</li>
<li>Una introduccion a MVCIntroduction to MVC</li>
<li>Un primer vistazo a la arquitectura Rails.</li>
<li>Un comienzo a los modelos de datos.</li>
<li>Una aplicación de red con database en produccion.<sup class="footnote" id="fnref:2.15"><a href="#fn:2.15">15</a></sup></li>
</ul>


<p><strong>Puntos Debiles</strong></p>

<ul>
<li>No existe un diseño</li>
<li>No hay páginas estaticas como la de "Home" o la de "About"</li>
<li>Los usuarios no tienen passwords</li>
<li>No hay imagenes de usuario</li>
<li>No se puede entrar o salir de la aplicación.</li>
<li>No hay seguridad alguna.</li>
<li>Las asociacion user/micropost no es automatica.</li>
<li>La idea de "seguidores" y "a seguir" no existe todavia. </li>
<li>No hay suministro de microposts.</li>
<li>No test-driven development</li>
<li><strong>No real understanding</strong></li>
</ul>

<p>El resto de este tutorial esta dedicado a reenforzar los puntos fuertes y eliminar los débiles.</p>

<div class="navigation">  <a class="prev_page" href="beginning#top">
    &laquo;&nbsp;<span class="number">Capitulo 1</span> From zero to deploy
  </a>
  <a class="next_page" href="static-pages#top">
    <span class="number">Chapter 3</span> Mostly static pages&nbsp;&raquo;
  </a>
</div><div class="footnotes">
<ol>
<li id="fn:2.1">Te pido que no profundices mucho en este código generado; por ahora, sólo servirá para confundirte. &nbsp;<a class="arrow" href="#fnref:2.1">&uarr;</a></li>
<li id="fn:2.2">Recuerda que la order <code>rails </code> genera por defecto un archivo llamado <code>.gitignore</code>, pero depende de tu sistema, podras encontrar un archivo aumentado en<a class="ref" href="beginning#code:gitignore">Listado&nbsp;1.5</a> que es un poco más conveniente.&nbsp;<a class="arrow" href="#fnref:2.2">&uarr;</a></li>
<li id="fn:2.3">Al modelar posts más largos, como en un blog (no-micro) normal, puedes usar el tipo <code>text</code> en lugar de <code>string</code>.&nbsp;<a class="arrow" href="#fnref:2.3">&uarr;</a></li>
<li id="fn:2.4">El nombre de este andamio sigue la convención de <em>modelos</em> que es el singular, en lugar del plural, que es para los recursos y los controladores. Así, se obtiene <code>User</code> en vez de <code>Users</code>.&nbsp;<a class="arrow" href="#fnref:2.4">&uarr;</a></li>
<li id="fn:2.5">El user id es necesario como la <em>llave primaria</em> en la base de datos.&nbsp;<a class="arrow" href="#fnref:2.5">&uarr;</a></li>
<li id="fn:2.6">Como la parte de la direccion <tt>http://localhost:3000</tt> es implicita cada vez que desarollamos localmente, la omitiré de aquí en adelante.&nbsp;<a class="arrow" href="#fnref:2.6">&uarr;</a></li>
<li id="fn:2.7">Algunas referencias indican que la vista regresa el HTML directo al browser (a través de un servidor como Apache o Nginx). Sean cuales sean los detalles de la implementación, prefiero pensar en los controladores como si fueran un eje que impulsa toda la informacion de nuestra aplicación.&nbsp;<a class="arrow" href="#fnref:2.7">&uarr;</a></li>
<li id="fn:2.8">Esta extraña anotación <code>:users</code> es un <em>símbolo</em>, del que aprenderemos más a fondo en la <a class="ref" href="rails-flavored-ruby#sec:hashes_and_symbols">Sección&nbsp;4.3.3</a>.&nbsp;<a class="arrow" href="#fnref:2.8">&uarr;</a></li>
<li id="fn:2.9">El código de andamio es muy feo y confuso, así que la he suprimido.&nbsp;<a class="arrow" href="#fnref:2.9">&uarr;</a></li>
<li id="fn:2.10">Recuerda que no es preciso entender todo este código ahora. Solo es mostrado para propositos de ilustración.&nbsp;<a class="arrow" href="#fnref:2.10">&uarr;</a></li>
<li id="fn:2.11">Así como en el andamio de Usuario, el andamio de microposts sigue la misma convención: los modelos en singular y los controladores y los recursos en plural. De allí obtenemos <code>generate Micropost</code>.&nbsp;<a class="arrow" href="#fnref:2.11">&uarr;</a></li>
<li id="fn:2.12">El código de andamio puede tener lineas extras comparado con <a class="ref" href="a-demo-app#code:demo_microposts_resource">Listado&nbsp;2.7</a>; no hay que preocuparse por esto, ya que Ruby ignora lineas extras.&nbsp;<a class="arrow" href="#fnref:2.12">&uarr;</a></li>
<li id="fn:2.13">Tu consola probalemente muestre algo como <code>ruby-1.9.2-head &gt;</code>, pero yo usaré <code>&gt;&gt;</code> para que la consola no este atada a ninguna versión específica de Ruby. &nbsp;<a class="arrow" href="#fnref:2.13">&uarr;</a></li>
<li id="fn:2.14">Normalmente, deberias hacer commits más pequeños y frecuentes, pero para el propósito de este capítulo, un commit más grande está bien.&nbsp;<a class="arrow" href="#fnref:2.14">&uarr;</a></li>
<li id="fn:2.15">Si ya has subido la aplicación a Heroku como en la <a class="ref" href="a-demo-app#sec:deploying_the_demo_app">Section&nbsp;2.3.5</a>.&nbsp;<a class="arrow" href="#fnref:2.15">&uarr;</a></li>
</ol>
</div>
